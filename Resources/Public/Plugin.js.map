{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/src/shims/vendor/react/index.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/src/shims/vendor/prop-types/index.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/src/shims/neosProjectPackages/neos-ui-redux-store/index.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/dist/readFromConsumerApi.js","webpack:///../commandbar/src/CommandBar.module.css?c6ee","webpack:///../commandbar/src/CommandBarFooter/CommandBarFooter.module.css?9bd0","webpack:///./src/actions/index.ts","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/src/shims/neosProjectPackages/react-ui-components/index.js","webpack:///../commandbar/src/CommandList/CommandListItem.module.css?a559","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/src/shims/vendor/redux-actions/index.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/src/shims/vendor/react-redux/index.js","webpack:///../commandbar/src/CommandBarHeader/CommandBarHeader.module.css?1317","webpack:///../commandbar/src/CommandList/CommandListing.module.css?4e9d","webpack:///./src/CommandBarUiPlugin.module.css?b47e","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/dist/registry/SynchronousRegistry.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/src/shims/neosProjectPackages/neos-ui-decorators/index.js","webpack:///../commandbar/src/Presentationals/Icon.module.css?bbc0","webpack:///../commandbar/src/SearchBox/SearchBox.module.css?9095","webpack:///../commandbar/src/CommandResultsView/CommandResultsView.module.css?8535","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/src/shims/neosProjectPackages/neos-ui-backend-connector/index.js","webpack:///./src/index.js","webpack:///./src/manifest.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/dist/index.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/dist/createConsumerApi.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/dist/manifest.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/dist/registry/index.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/dist/registry/AbstractRegistry.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/positional-array-sorter/dist/positionalArraySorter.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/tslib/tslib.es6.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/@neos-project/neos-ui-extensibility/dist/registry/SynchronousMetaRegistry.js","webpack:///../commandbar/src/state/commandBarReducer.ts","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/fuzzy-search/src/Helper.js","webpack:////Users/sebastianhelzle/Workspace/helzle.it/Packages/Plugins/Shel.Neos.CommandBar/node_modules/fuzzy-search/src/FuzzySearch.js","webpack:///../commandbar/src/Presentationals/Icon.tsx","webpack:///../commandbar/src/CommandBarFooter/CommandBarFooter.tsx","webpack:///../commandbar/src/SearchBox/SearchBox.tsx","webpack:///../commandbar/src/CommandBarHeader/CommandBarHeader.tsx","webpack:///../commandbar/src/CommandList/CommandListItem.tsx","webpack:///../commandbar/src/CommandList/CommandListing.tsx","webpack:///../commandbar/src/helpers/flattenCommands.ts","webpack:///../commandbar/src/CommandResultsView/CommandResultsView.tsx","webpack:///../commandbar/src/CommandBar.tsx","webpack:///./src/helpers/fetchData.ts","webpack:///./src/CommandBarUiPlugin.tsx"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","React","PropTypes","NeosUiReduxStore","__read","iterator","e","ar","next","done","push","error","__spreadArray","to","from","pack","arguments","length","Array","slice","concat","readFromConsumerApi","_a","args","_i","window","apply","Error","actionTypes","TOGGLE_COMMAND_BAR","actions","toggleCommandBar","reducer","state","action","_b","plugins","commandBar","open","undefined","payload","selectors","commandBarOpen","ReactUiComponents","reduxActions","reactRedux","extendStatics","__extends","b","setPrototypeOf","__proto__","TypeError","String","__","this","constructor","__importDefault","mod","AbstractRegistry_1","require","positional_array_sorter_1","SynchronousRegistry","_super","description","_this","_registry","set","position","entry","indexOfItemWithTheSameKey","findIndex","item","console","result","find","_getChildrenWrapped","searchKey","unsortedChildren","filter","indexOf","getChildrenAsObject","forEach","getChildren","map","has","Boolean","_getAllWrapped","getAllAsObject","getAllAsList","assign","id","NeosUiDecorators","NeosUiBackendConnectorDefault","fetchWithErrorHandling","NeosUiBackendConnector","globalRegistry","store","frontendConfiguration","enabled","extensibilityTest","icon","canHandleQueries","query","getState","documentNode","CR","Nodes","documentNodeSelector","alert","contextPath","CommandBarUiPlugin","hotkeys","hotkeyRegistry","SynchronousMetaRegistry","createConsumerApi","createConsumerApi_1","readFromConsumerApi_1","index_1","manifest_1","createReadOnlyValue","writable","configurable","manifests","exposureMap","api","keys","identifier","options","bootstrap","SynchronousRegistry_1","SynchronousMetaRegistry_1","AbstractRegistry","SERIAL_VERSION_UID","tslib_1","positionalArraySorter","subject","idKey","e_1","e_2","e_3","_c","e_4","_d","e_5","_e","e_6","_f","e_7","_g","positionAccessor","indexMapping","middleKeys","startKeys","endKeys","beforeKeys","afterKeys","index","positionValue","invalid","startsWith","weight","weightMatch","match","Number","reference","numberPosition","parseFloat","isNaN","isFinite","resultStart","resultMiddle","resultEnd","processedKeys","sortedWeights","dict","asc","weights","x","sort","a","reverse","addToResults","e_8","e_9","beforeWeights","beforeWeights_1","__values","beforeWeights_1_1","e_8_1","afterWeights","afterWeights_1","afterWeights_1_1","e_9_1","_h","_j","e_1_1","_k","_l","e_2_1","_m","_o","e_3_1","_p","_q","_r","_s","e_5_1","e_4_1","_t","_u","_v","_w","e_7_1","e_6_1","__spread","__assign","__rest","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","target","desc","getOwnPropertyDescriptor","Reflect","decorate","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","rejected","adopt","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","v","op","pop","__createBinding","k","k2","__exportStar","__spreadArrays","il","j","jl","__await","__asyncGenerator","asyncIterator","q","resume","fulfill","settle","shift","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__importStar","default","__classPrivateFieldGet","receiver","privateMap","__classPrivateFieldSet","ACTIONS","Helper","path","list","firstSegment","remaining","dotIndex","toString","getDescendantProperty","haystack","isArray","caseSensitive","results","score","isMatch","propertyValues","found","z","toLocaleLowerCase","indexes","nearestIndexesFor","letters","split","indexesOfFirstLetter","startingIndex","loopingIndex","letter","letterIndexes","clamp","min","max","Math","filterAvailableCommands","selectedCommandGroup","searchWord","commands","availableCommands","values","command","parentId","matchingCommands","search","Set","commandBarReducer","parentCommandGroup","type","RESET_SEARCH","highlightedItem","availableCommandIds","HIGHLIGHT_NEXT_ITEM","expanded","HIGHLIGHT_PREVIOUS_ITEM","CANCEL","GO_TO_PARENT_GROUP","SELECT_GROUP","commandId","UPDATE_SEARCH","argument","RUNNING_COMMAND","runningCommandId","runningCommandMessage","FINISHED_COMMAND","SET_RESULT","spin","className","selectedGroup","runningCommand","href","title","rel","xmlns","width","height","viewBox","gradientUnits","x1","y1","x2","y2","offset","stopColor","fill","transform","onChange","inputRef","handleKeyPress","current","preventDefault","stopPropagation","ref","placeholder","autoFocus","onKeyUp","dispatch","handleSearch","createElement","onClick","CommandListItem","forwardRef","onItemSelect","highlighted","join","displayName","memo","prev","handleSelectItem","heading","noCommandsMessage","selectedElementRef","useRef","scrollIntoView","behavior","block","flattenCommands","reduce","commandList","subCommands","absoluteCommandId","subCommandIds","subCommandId","view","message","debug","location","initialState","useRefEventListener","fn","fnRef","toggleOpen","handleKeyEnteredRef","defaultPrevented","toLowerCase","async","actionResult","catch","finally","warn","handleSelectItemRef","windowKeyEventHandler","addEventListener","removeEventListener","endpoint","params","url","encodeURIComponent","withCsrfToken","csrfToken","method","credentials","headers","response","json","props","super","buildCommandsFromHotkeys","handleHotkeyAction","config","carry","includes","mapHotkeyIdToIcon","buildCommandsFromEditPreviewModes","setEditPreviewMode","editPreviewModes","i18nRegistry","isEditingMode","translate","editPreviewMode","handleAddNode","addNode","focusedNodeContextPath","handleSearchNode","siteNode","setActiveContentCanvasContextPath","setActiveContentCanvasSrc","success","node","nodetype","uri","handlePublish","publishableNodesInDocument","publishAction","baseWorkspace","handlePublishAll","publishableNodes","handleDiscard","discardAction","handleDiscardAll","loaded","searchDocuments","publishDiscard","publish","publishAll","discard","discardAll","quickActions","switchEditPreviewMode","actionName","pluginName","pluginCommands","setState","isActive","disabled","propTypes","isRequired","string","bool","func","array","isWorkspaceReadOnly","mapGlobalRegistryToProps","nodeTypesRegistry","commenceCreation","UI","EditPreviewMode","Workspaces","commenceDiscard","setDocumentNode","ContentCanvas","setSrc","siteNodeSelector","focusedNodePathSelector","publishableNodesSelector","publishableNodesInDocumentSelector","isWorkspaceReadOnlySelector","baseWorkspaceSelector","currentEditPreviewMode"],"mappings":";aACE,IAAIA,EAAmB,GAGvB,SAASC,oBAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,qBAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,oBAAoBQ,EAAIF,EAGxBN,oBAAoBS,EAAIV,EAGxBC,oBAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,oBAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,oBAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,oBAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,oBAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,oBAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,oBAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,oBAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,SAASM,aAAe,OAAO3B,EAAgB,SAC/C,SAAS4B,mBAAqB,OAAO5B,GAEtC,OADAH,oBAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,oBAAoBa,EAAI,SAASmB,EAAQC,GAAY,OAAOnB,OAAOoB,UAAUC,eAAe5B,KAAKyB,EAAQC,IAGzGjC,oBAAoBoC,EAAI,GAIjBpC,oBAAoBA,oBAAoBqC,EAAI,I,+BClFrD,I,2EAAA,MAEAlC,EAAOD,SAAU,aAAoB,SAApB,GAAgCoC,O,6BCFjD,I,2EAAA,MAEAnC,EAAOD,SAAU,aAAoB,SAApB,GAAgCqC,W,6BCFjD,I,2EAAA,MAEApC,EAAOD,SAAU,aAAoB,sBAApB,GAA6CsC,kB,6BCD9D,IAAIC,OAAkC,SAAU5B,EAAGgB,GAC/C,IAAIrB,EAAsB,mBAAXW,QAAyBN,EAAEM,OAAOuB,UACjD,IAAKlC,EAAG,OAAOK,EACf,IAAmBK,EAAYyB,EAA3BvC,EAAII,EAAED,KAAKM,GAAO+B,EAAK,GAC3B,IACI,WAAc,IAANf,GAAgBA,KAAM,MAAQX,EAAId,EAAEyC,QAAQC,MAAMF,EAAGG,KAAK7B,EAAEG,OAExE,MAAO2B,GAASL,EAAI,CAAEK,MAAOA,GAH7B,QAKI,IACQ9B,IAAMA,EAAE4B,OAAStC,EAAIJ,EAAA,SAAcI,EAAED,KAAKH,GADlD,QAGU,GAAIuC,EAAG,MAAMA,EAAEK,OAE7B,OAAOJ,GAEPK,cAAgD,SAAUC,EAAIC,EAAMC,GACpE,GAAIA,GAA6B,IAArBC,UAAUC,OAAc,IAAK,IAA4BV,EAAxBxC,EAAI,EAAGC,EAAI8C,EAAKG,OAAYlD,EAAIC,EAAGD,KACxEwC,GAAQxC,KAAK+C,IACRP,IAAIA,EAAKW,MAAMrB,UAAUsB,MAAMjD,KAAK4C,EAAM,EAAG/C,IAClDwC,EAAGxC,GAAK+C,EAAK/C,IAGrB,OAAO8C,EAAGO,OAAOb,GAAMW,MAAMrB,UAAUsB,MAAMjD,KAAK4C,KAEtDjD,EAAQsB,YAAa,EAcrBtB,EAAA,QAbA,SAASwD,oBAAoB/B,GACzB,OAAO,WAGH,IAFA,IAAIgC,EACAC,EAAO,GACFC,EAAK,EAAGA,EAAKR,UAAUC,OAAQO,IACpCD,EAAKC,GAAMR,UAAUQ,GAEzB,GAAIC,OAAO,wBAA0BA,OAAO,uBAAuB,IAAIL,OAAO9B,IAC1E,OAAQgC,EAAKG,OAAO,wBAAwB,IAAIL,OAAO9B,IAAMoC,MAAMJ,EAAIV,cAAc,GAAIR,OAAOmB,IAAO,IAE3G,MAAM,IAAII,MAAM,mF,gBCpCxB7D,EAAOD,QAAU,CAAC,WAAa,wCAAwC,WAAa,wCAAwC,YAAc,yCAAyC,SAAW,sCAAsC,MAAQ,qC,gBCA5OC,EAAOD,QAAU,CAAC,iBAAmB,oDAAoD,WAAa,8CAA8C,SAAW,4CAA4C,aAAe,kD,6BCD1N,wLACO,MAAM+D,EAAc,CACvBC,mBAAoB,sBAGXC,EAAU,CACnBC,iBAFqB,uBAAaH,EAAYC,qBAIrCG,EAAU,wBAAc,CACjCH,mBAAoB,CAACI,EAAOC,KACxB,IAAIZ,EAAIa,EACR,MAAO,IACAF,EACHG,QAAS,IACFH,EAAMG,QACTC,WAAY,CACRC,UAAyBC,IAAnBL,EAAOM,QAAwBN,EAAOM,QAAQF,OAA4F,QAAlFH,EAA8B,QAAxBb,EAAKW,EAAMG,eAA4B,IAAPd,OAAgB,EAASA,EAAGe,kBAA+B,IAAPF,OAAgB,EAASA,EAAGG,WAKrM,CACCF,QAAS,CACLC,WAAY,CACRC,MAAM,MAILG,EAAY,CACrBC,eAAiBT,IAAY,IAAIX,EAAIa,EAAI,OAA0F,QAAlFA,EAA8B,QAAxBb,EAAKW,EAAMG,eAA4B,IAAPd,OAAgB,EAASA,EAAGe,kBAA+B,IAAPF,OAAgB,EAASA,EAAGG,Q,6BC7B3K,I,2EAAA,MAEAxE,EAAOD,SAAU,aAAoB,sBAApB,GAA6C8E,mB,gBCD9D7E,EAAOD,QAAU,CAAC,gBAAkB,kDAAkD,YAAc,8CAA8C,MAAQ,0C,6BCD1J,I,2EAAA,MAEAC,EAAOD,SAAU,aAAoB,SAApB,GAAgC+E,c,6BCFjD,I,2EAAA,MAEA9E,EAAOD,SAAU,aAAoB,SAApB,GAAgCgF,Y,gBCDjD/E,EAAOD,QAAU,CAAC,iBAAmB,oDAAoD,WAAa,gD,gBCAtGC,EAAOD,QAAU,CAAC,QAAU,yCAAyC,UAAY,6C,gBCAjFC,EAAOD,QAAU,CAAC,gBAAkB,qDAAqD,KAAO,4C,6BCAhG,IACQiF,EADJC,GACID,EAAgB,SAAS,cAACzE,EAAG2E,GAI7B,OAHAF,EAAgBrE,OAAOwE,gBAClB,CAAEC,UAAW,cAAgBhC,OAAS,SAAU7C,EAAG2E,GAAK3E,EAAE6E,UAAYF,IACvE,SAAU3E,EAAG2E,GAAK,IAAK,IAAIjD,KAAKiD,EAAOvE,OAAOoB,UAAUC,eAAe5B,KAAK8E,EAAGjD,KAAI1B,EAAE0B,GAAKiD,EAAEjD,MAC3E1B,EAAG2E,IAErB,SAAU3E,EAAG2E,GAChB,GAAiB,mBAANA,GAA0B,OAANA,EAC3B,MAAM,IAAIG,UAAU,uBAAyBC,OAAOJ,GAAK,iCAE7D,SAASK,KAAOC,KAAKC,YAAclF,EADnCyE,EAAczE,EAAG2E,GAEjB3E,EAAEwB,UAAkB,OAANmD,EAAavE,OAAOY,OAAO2D,IAAMK,GAAGxD,UAAYmD,EAAEnD,UAAW,IAAIwD,MAGnFG,gBAAoD,SAAUC,GAC9D,OAAQA,GAAOA,EAAItE,WAAcsE,EAAM,CAAE,QAAWA,IAExD5F,EAAQsB,YAAa,EACrB,IAAIuE,EAAqBF,gBAAgBG,EAAQ,KAC7CC,EAA4BJ,gBAAgBG,EAAQ,KACpDE,EAAuB,SAAUC,GAEjC,SAASD,oBAAoBE,GACzB,IAAIC,EAAQF,EAAO5F,KAAKoF,KAAMS,IAAgBT,KAE9C,OADAU,EAAMC,UAAY,GACXD,EAiEX,OArEAjB,EAAUc,oBAAqBC,GAM/BD,oBAAoBhE,UAAUqE,IAAM,SAAU5E,EAAKN,EAAOmF,GAEtD,QADiB,IAAbA,IAAuBA,EAAW,GACnB,iBAAR7E,EACP,MAAM,IAAIqC,MAAM,wBAEpB,GAAwB,iBAAbwC,GAA6C,iBAAbA,EACvC,MAAM,IAAIxC,MAAM,yCAEpB,IAAIyC,EAAQ,CAAE9E,IAAKA,EAAKN,MAAOA,GAC3BmF,IACAC,EAAMD,SAAWA,GAErB,IAAIE,EAA4Bf,KAAKW,UAAUK,WAAU,SAAUC,GAAQ,OAAOA,EAAKjF,MAAQA,KAO/F,OANmC,IAA/B+E,EACAf,KAAKW,UAAUvD,KAAK0D,GAGpBd,KAAKW,UAAUI,GAA6BD,EAEzCpF,GAEX6E,oBAAoBhE,UAAUjB,IAAM,SAAUU,GAC1C,GAAmB,iBAARA,EAEP,OADAkF,QAAQ7D,MAAM,wBACP,KAEX,IAAI8D,EAASnB,KAAKW,UAAUS,MAAK,SAAUH,GAAQ,OAAOA,EAAKjF,MAAQA,KACvE,OAAOmF,EAASA,EAAOzF,MAAQ,MAEnC6E,oBAAoBhE,UAAU8E,oBAAsB,SAAUC,GAC1D,IAAIC,EAAmBvB,KAAKW,UAAUa,QAAO,SAAUP,GAAQ,OAA6C,IAAtCA,EAAKjF,IAAIyF,QAAQH,EAAY,QACnG,OAAO,EAAIhB,EAAA,SAAsCiB,IAErDhB,oBAAoBhE,UAAUmF,oBAAsB,SAAUJ,GAC1D,IAAIH,EAAS,GAIb,OAHAnB,KAAKqB,oBAAoBC,GAAWK,SAAQ,SAAUV,GAClDE,EAAOF,EAAKjF,KAAOiF,EAAKvF,SAErByF,GAEXZ,oBAAoBhE,UAAUqF,YAAc,SAAUN,GAClD,OAAOtB,KAAKqB,oBAAoBC,GAAWO,KAAI,SAAUZ,GAAQ,OAAOA,EAAKvF,UAEjF6E,oBAAoBhE,UAAUuF,IAAM,SAAU9F,GAC1C,MAAmB,iBAARA,GACPkF,QAAQ7D,MAAM,yBACP,GAEJ0E,QAAQ/B,KAAKW,UAAUS,MAAK,SAAUH,GAAQ,OAAOA,EAAKjF,MAAQA,OAE7EuE,oBAAoBhE,UAAUyF,eAAiB,WAC3C,OAAO,EAAI1B,EAAA,SAAsCN,KAAKW,YAE1DJ,oBAAoBhE,UAAU0F,eAAiB,WAC3C,IAAId,EAAS,GAIb,OAHAnB,KAAKgC,iBAAiBL,SAAQ,SAAUV,GACpCE,EAAOF,EAAKjF,KAAOiF,EAAKvF,SAErByF,GAEXZ,oBAAoBhE,UAAU2F,aAAe,WACzC,OAAOlC,KAAKgC,iBAAiBH,KAAI,SAAUZ,GAAQ,OAAO9F,OAAOgH,OAAO,CAAEC,GAAInB,EAAKjF,KAAOiF,EAAKvF,WAE5F6E,oBAtEgB,CAuEzBH,EAAA,SACF7F,EAAA,QAAqBgG,G,6BC9FrB,I,2EAAA,MAEA/F,EAAOD,SAAU,aAAoB,sBAApB,GAA6C8H,kB,gBCD9D7H,EAAOD,QAAU,CAAC,SAAW,kC,gBCA7BC,EAAOD,QAAU,CAAC,UAAY,wC,gBCA9BC,EAAOD,QAAU,CAAC,mBAAqB,0D,8GCDvC,I,2EAAA,M,WAEe,aAAoB,sBAApB,GAA6C+H,8B,IAErDC,GAA0B,aAAoB,sBAApB,GAA6CC,uBAAvED,uB,EACCA,0B,6BCLRlC,EAAQ,K,6BCAR,Y,4BACA,OAEA,O,yBACA,O,yEAEA,aAAS,kCAAmC,IAAI,SAACoC,EAAD,GAAsD,IAAnCC,EAAmC,EAAnCA,MAAOC,EAA4B,EAA5BA,sBAGtE,GAFoBA,EAAsB,mCAAlCC,UAORH,EAAe7B,IACX,uBACA,IAAIL,sBAAJ,8DAMJkC,EAAenH,IAAI,wBAAwBsF,IAAI,gBAAgB,WAC3D,MAAO,CACHiC,kBAAmB,CACf7H,KAAM,qBACN8H,KAAM,OACNrC,YAAa,mDACbsC,kBAAkB,EAClBnE,QAAA,E,0TAAA,0BAAQ,iBAAOoE,GAAP,iGACErE,EAAQ+D,EAAMO,WACdC,EAAe/D,YAAUgE,GAAGC,MAAMC,qBAAqB1E,GAC7DR,OAAOmF,MAAP,gCAA6CJ,EAAaK,YAA1D,qBAA0FP,EAA1F,KAHI,wDAAR,SAAApE,OAAA,sCAAAA,IAAA,KAUZ6D,EAAenH,IAAI,cAAcsF,IAAI,mCAAoC4C,WAGzEf,EAAenH,IAAI,YAAYsF,IAAI,uBAAwB,CAAElC,oBAGvB,OAAlCiE,EAAsBc,SAA6D,IAAzCd,EAAsBc,QAAQ9F,QAAc,CACtF,IAAM+F,EAAiBjB,EAAenH,IAAI,WAC1CoI,EAAe9C,IAAI,kCAAmC,CAClDH,YAAa,qBACb7B,OAAQJ,UAAQC,mBAEpBiF,EAAe9C,IAAI,mCAAoC,CACnDH,YAAa,qBACb7B,OAAQJ,UAAQC,wB,6BCpD5B,IAAIyB,gBAAoD,SAAUC,GAC9D,OAAQA,GAAOA,EAAItE,WAAcsE,EAAM,CAAE,QAAWA,IAExD5F,EAAQsB,YAAa,EACrBtB,EAAQoJ,wBAA0BpJ,EAAQgG,oBAAsBhG,EAAQwD,oBAAsBxD,EAAQqJ,uBAAoB,EAC1H,IAAIC,EAAsB3D,gBAAgBG,EAAQ,KAClD9F,EAAQqJ,kBAAoBC,EAAA,QAC5B,IAAIC,EAAwB5D,gBAAgBG,EAAQ,IACpD9F,EAAQwD,oBAAsB+F,EAAA,QAC9B,IAAIC,EAAU1D,EAAQ,IACtB9F,EAAQgG,oBAAsBwD,EAAQxD,oBACtChG,EAAQoJ,wBAA0BI,EAAQJ,wBAC1CpJ,EAAA,SAAqB,EAAIuJ,EAAA,SAAkC,a,6BCZ3D,IAAI5D,gBAAoD,SAAUC,GAC9D,OAAQA,GAAOA,EAAItE,WAAcsE,EAAM,CAAE,QAAWA,IAExD5F,EAAQsB,YAAa,EACrB,IAAImI,EAAa9D,gBAAgBG,EAAQ,KACrC4D,EAAsB,SAAtBA,oBAAgCvI,GAAS,MAAQ,CACjDA,MAAOA,EACPwI,UAAU,EACV7I,YAAY,EACZ8I,cAAc,IAUlB5J,EAAA,QARA,SAASqJ,kBAAkBQ,EAAWC,GAClC,IAAIC,EAAM,GACVnJ,OAAOoJ,KAAKF,GAAa1C,SAAQ,SAAU3F,GACvCb,OAAOC,eAAekJ,EAAKtI,EAAKiI,EAAoBI,EAAYrI,QAEpEb,OAAOC,eAAekJ,EAAK,YAAaL,GAAoB,EAAID,EAAA,SAAuBI,KACvFjJ,OAAOC,eAAe+C,OAAQ,sBAAuB8F,EAAoBK,M,6BCjB7E/J,EAAQsB,YAAa,EACrBtB,EAAA,QAAsB,SAAU6J,GAC5B,OAAO,SAAUI,EAAYC,EAASC,GAClC,IAAI1G,EACJoG,EAAUhH,OAAMY,EAAK,IACdwG,GAAc,CACbC,QAASA,EACTC,UAAWA,GAEf1G,O,6BCTZ,IAAIkC,gBAAoD,SAAUC,GAC9D,OAAQA,GAAOA,EAAItE,WAAcsE,EAAM,CAAE,QAAWA,IAExD5F,EAAQsB,YAAa,EACrBtB,EAAQoJ,wBAA0BpJ,EAAQgG,yBAAsB,EAChE,IAAIoE,EAAwBzE,gBAAgBG,EAAQ,KACpD9F,EAAQgG,oBAAsBoE,EAAA,QAC9B,IAAIC,EAA4B1E,gBAAgBG,EAAQ,KACxD9F,EAAQoJ,wBAA0BiB,EAAA,S,6BCRlCrK,EAAQsB,YAAa,EACrB,IAAIgJ,EACA,SAASA,EAAiBpE,GACtBT,KAAK8E,mBAAqB,uCAC1B9E,KAAKS,YAAcA,GAI3BlG,EAAA,QAAqBsK,G,6BCRrBtK,EAAQsB,YAAa,EACrB,IAAIkJ,EAAU1E,EAAQ,IAsOtB9F,EAAA,QArO4B,SAAxByK,sBAAkCC,EAASpE,EAAUqE,GACrD,IAAIC,EAAKnH,EAAIoH,EAAKvG,EAAIwG,EAAKC,EAAIC,EAAKC,EAAIC,EAAKC,EAAIC,EAAKC,EAAIC,EAAKC,OAC9C,IAAbjF,IAAuBA,EAAW,iBACxB,IAAVqE,IAAoBA,EAAQ,OAChC,IAAIa,EAAuC,iBAAblF,EAAwB,SAAUnF,GAAS,OAAOA,EAAMmF,IAAeA,EACjGmF,EAAe,GACfC,EAAa,GACbC,EAAY,GACZC,EAAU,GACVC,EAAa,GACbC,EAAY,GAChBpB,EAAQtD,SAAQ,SAAUV,EAAMqF,GAC5B,IAAItK,EAAMiF,EAAKiE,GAASjE,EAAKiE,GAASpF,OAAOwG,GAC7CN,EAAahK,GAAOsK,EACpB,IAAIC,EAAgBR,EAAiB9E,GACjCJ,EAAWf,OAAOyG,GAAgCD,GAClDE,GAAU,EACd,GAAI3F,EAAS4F,WAAW,SAAU,CAC9B,IACIC,GADAC,EAAc9F,EAAS+F,MAAM,mBACLD,EAAY,GAAKE,OAAOF,EAAY,IAAM,EACjET,EAAUQ,KACXR,EAAUQ,GAAU,IAExBR,EAAUQ,GAAQtJ,KAAKpB,QAEtB,GAAI6E,EAAS4F,WAAW,OAAQ,CACjC,IAAIE,EACAD,GADAC,EAAc9F,EAAS+F,MAAM,iBACLD,EAAY,GAAKE,OAAOF,EAAY,IAAM,EACjER,EAAQO,KACTP,EAAQO,GAAU,IAEtBP,EAAQO,GAAQtJ,KAAKpB,QAEpB,GAAI6E,EAAS4F,WAAW,UAAW,CAEpC,GADIG,EAAQ/F,EAAS+F,MAAM,6BAItB,CACD,IAAIE,EAAYF,EAAM,GAClBF,EAASE,EAAM,GAAKC,OAAOD,EAAM,IAAM,EACtCR,EAAWU,KACZV,EAAWU,GAAa,IAEvBV,EAAWU,GAAWJ,KACvBN,EAAWU,GAAWJ,GAAU,IAEpCN,EAAWU,GAAWJ,GAAQtJ,KAAKpB,QAXnCwK,GAAU,OAcb,GAAI3F,EAAS4F,WAAW,SAAU,CACnC,IAAIG,EACJ,GADIA,EAAQ/F,EAAS+F,MAAM,4BAItB,CACGE,EAAYF,EAAM,GAClBF,EAASE,EAAM,GAAKC,OAAOD,EAAM,IAAM,EACtCP,EAAUS,KACXT,EAAUS,GAAa,IAEtBT,EAAUS,GAAWJ,KACtBL,EAAUS,GAAWJ,GAAU,IAEnCL,EAAUS,GAAWJ,GAAQtJ,KAAKpB,QAXlCwK,GAAU,OAedA,GAAU,EAEd,GAAIA,EAAS,CACT,IAAIO,EAAiBC,WAAWnG,IAC5BoG,MAAMF,IAAoBG,SAASH,KACnCA,EAAiBT,GAEhBL,EAAWc,KACZd,EAAWc,GAAkB,IAEjCd,EAAWc,GAAgB3J,KAAKpB,OAGxC,IAAImL,EAAc,GACdC,EAAe,GACfC,EAAY,GACZC,EAAgB,GAChBC,EAAgB,SAAhBA,cAA0BC,EAAMC,GAChC,IAAIC,EAAUvM,OAAOoJ,KAAKiD,GAAM3F,KAAI,SAAU8F,GAAK,OAAOd,OAAOc,MAAOC,MAAK,SAAUC,EAAGnI,GAAK,OAAOmI,EAAInI,KAC1G,OAAO+H,EAAMC,EAAUA,EAAQI,WAE/BC,EAAe,SAAfA,aAAyBxD,EAAMpD,GAC/BoD,EAAK5C,SAAQ,SAAU3F,GACnB,IAAIgM,EAAKhK,EAAIiK,EAAKpJ,EAClB,KAAIyI,EAAc7F,QAAQzF,IAAQ,GAAlC,CAIA,GADAsL,EAAclK,KAAKpB,GACfoK,EAAWpK,GAAM,CACjB,IAAIkM,EAAgBX,EAAcnB,EAAWpK,IAAM,GACnD,IACI,IAAK,IAAImM,EAAkBpD,EAAQqD,SAASF,GAAgBG,EAAoBF,EAAgBjL,QAASmL,EAAkBlL,KAAMkL,EAAoBF,EAAgBjL,OAAQ,CACzK,IAAIzC,EAAI4N,EAAkB3M,MAC1BqM,aAAa3B,EAAWpK,GAAKvB,GAAI0G,IAGzC,MAAOmH,GAASN,EAAM,CAAE3K,MAAOiL,GAN/B,QAQI,IACQD,IAAsBA,EAAkBlL,OAASa,EAAKmK,EAAA,SAA4BnK,EAAGpD,KAAKuN,GADlG,QAGU,GAAIH,EAAK,MAAMA,EAAI3K,QAIrC,GADA8D,EAAO/D,KAAKpB,GACRqK,EAAUrK,GAAM,CAChB,IAAIuM,EAAehB,EAAclB,EAAUrK,IAAM,GACjD,IACI,IAAK,IAAIwM,EAAiBzD,EAAQqD,SAASG,GAAeE,EAAmBD,EAAetL,QAASuL,EAAiBtL,KAAMsL,EAAmBD,EAAetL,OAAQ,CAC9JzC,EAAIgO,EAAiB/M,MACzBqM,aAAa1B,EAAUrK,GAAKvB,GAAI0G,IAGxC,MAAOuH,GAAST,EAAM,CAAE5K,MAAOqL,GAN/B,QAQI,IACQD,IAAqBA,EAAiBtL,OAAS0B,EAAK2J,EAAA,SAA2B3J,EAAGjE,KAAK4N,GAD/F,QAGU,GAAIP,EAAK,MAAMA,EAAI5K,cAK7C,IACI,IAAK,IAAIsL,EAAK5D,EAAQqD,SAASb,EAAcrB,GAAW,IAAS0C,EAAKD,EAAGzL,QAAS0L,EAAGzL,KAAMyL,EAAKD,EAAGzL,OAAQ,CACvG,IAAIzC,EAAImO,EAAGlN,MACXqM,EAAa7B,EAAUzL,GAAI0M,IAGnC,MAAO0B,GAAS1D,EAAM,CAAE9H,MAAOwL,GAN/B,QAQI,IACQD,IAAOA,EAAGzL,OAASa,EAAK2K,EAAA,SAAe3K,EAAGpD,KAAK+N,GADvD,QAGU,GAAIxD,EAAK,MAAMA,EAAI9H,OAEjC,IACI,IAAK,IAAIyL,EAAK/D,EAAQqD,SAASb,EAActB,GAAY,IAAQ8C,EAAKD,EAAG5L,QAAS6L,EAAG5L,KAAM4L,EAAKD,EAAG5L,OAAQ,CACnGzC,EAAIsO,EAAGrN,MACXqM,EAAa9B,EAAWxL,GAAI2M,IAGpC,MAAO4B,GAAS5D,EAAM,CAAE/H,MAAO2L,GAN/B,QAQI,IACQD,IAAOA,EAAG5L,OAAS0B,EAAKiK,EAAA,SAAejK,EAAGjE,KAAKkO,GADvD,QAGU,GAAI1D,EAAK,MAAMA,EAAI/H,OAEjC,IACI,IAAK,IAAI4L,EAAKlE,EAAQqD,SAASb,EAAcpB,GAAS,IAAQ+C,EAAKD,EAAG/L,QAASgM,EAAG/L,KAAM+L,EAAKD,EAAG/L,OAAQ,CAChGzC,EAAIyO,EAAGxN,MACXqM,EAAa5B,EAAQ1L,GAAI4M,IAGjC,MAAO8B,GAAS9D,EAAM,CAAEhI,MAAO8L,GAN/B,QAQI,IACQD,IAAOA,EAAG/L,OAASmI,EAAK2D,EAAA,SAAe3D,EAAG1K,KAAKqO,GADvD,QAGU,GAAI5D,EAAK,MAAMA,EAAIhI,OAEjC,IACI,IAAK,IAAI+L,EAAKrE,EAAQqD,SAASjN,OAAOoJ,KAAK6B,IAAciD,EAAKD,EAAGlM,QAASmM,EAAGlM,KAAMkM,EAAKD,EAAGlM,OAAQ,CAC/F,IAAIlB,EAAMqN,EAAG3N,MACb,KAAI4L,EAAc7F,QAAQzF,IAAQ,GAGlC,IACI,IAAK,IAAIsN,GAAM7D,OAAM,EAAQV,EAAQqD,SAASb,EAAcnB,EAAWpK,IAAM,KAAUuN,EAAKD,EAAGpM,QAASqM,EAAGpM,KAAMoM,EAAKD,EAAGpM,OAAQ,CACzHzC,EAAI8O,EAAG7N,MACXqM,EAAa3B,EAAWpK,GAAKvB,GAAI0M,IAGzC,MAAOqC,GAAS/D,EAAM,CAAEpI,MAAOmM,GAN/B,QAQI,IACQD,IAAOA,EAAGpM,OAASuI,EAAK4D,EAAA,SAAe5D,EAAG9K,KAAK0O,GADvD,QAGU,GAAI7D,EAAK,MAAMA,EAAIpI,SAIzC,MAAOoM,GAASlE,EAAM,CAAElI,MAAOoM,GArB/B,QAuBI,IACQJ,IAAOA,EAAGlM,OAASqI,EAAK4D,EAAA,SAAe5D,EAAG5K,KAAKwO,GADvD,QAGU,GAAI7D,EAAK,MAAMA,EAAIlI,OAEjC,IACI,IAAK,IAAIqM,EAAK3E,EAAQqD,SAASjN,OAAOoJ,KAAK8B,IAAasD,EAAKD,EAAGxM,QAASyM,EAAGxM,KAAMwM,EAAKD,EAAGxM,OAAQ,CAC1FlB,EAAM2N,EAAGjO,MACb,KAAI4L,EAAc7F,QAAQzF,IAAQ,GAGlC,IACI,IAAK,IAAI4N,GAAM/D,OAAM,EAAQd,EAAQqD,SAASb,EAAclB,EAAUrK,IAAM,KAAU6N,EAAKD,EAAG1M,QAAS2M,EAAG1M,KAAM0M,EAAKD,EAAG1M,OAAQ,CACxHzC,EAAIoP,EAAGnO,MACXqM,EAAa1B,EAAUrK,GAAKvB,GAAI2M,IAGxC,MAAO0C,GAASjE,EAAM,CAAExI,MAAOyM,GAN/B,QAQI,IACQD,IAAOA,EAAG1M,OAAS2I,EAAK8D,EAAA,SAAe9D,EAAGlL,KAAKgP,GADvD,QAGU,GAAI/D,EAAK,MAAMA,EAAIxI,SAIzC,MAAO0M,GAASpE,EAAM,CAAEtI,MAAO0M,GArB/B,QAuBI,IACQJ,IAAOA,EAAGxM,OAASyI,EAAK8D,EAAA,SAAe9D,EAAGhL,KAAK8O,GADvD,QAGU,GAAI/D,EAAK,MAAMA,EAAItI,OAGjC,OADiB0H,EAAQiF,SAAS7C,EAAaC,EAAcC,GAC3CxF,KAAI,SAAU7F,GAAO,OAAOgK,EAAahK,MAAS6F,KAAI,SAAUpH,GAAK,OAAOwK,EAAQxK,Q,6BCtO1G,+wCAgBA,IAAI+E,cAAgB,SAASzE,EAAG2E,GAI5B,OAHAF,cAAgBrE,OAAOwE,gBAClB,CAAEC,UAAW,cAAgBhC,OAAS,SAAU7C,EAAG2E,GAAK3E,EAAE6E,UAAYF,IACvE,SAAU3E,EAAG2E,GAAK,IAAK,IAAIjD,KAAKiD,EAAOA,EAAElD,eAAeC,KAAI1B,EAAE0B,GAAKiD,EAAEjD,MACpD1B,EAAG2E,IAGrB,SAASD,UAAU1E,EAAG2E,GAEzB,SAASK,KAAOC,KAAKC,YAAclF,EADnCyE,cAAczE,EAAG2E,GAEjB3E,EAAEwB,UAAkB,OAANmD,EAAavE,OAAOY,OAAO2D,IAAMK,GAAGxD,UAAYmD,EAAEnD,UAAW,IAAIwD,IAG5E,IAAIkK,SAAW,WAQlB,OAPAA,SAAW9O,OAAOgH,QAAU,SAAS8H,SAAStO,GAC1C,IAAK,IAAIe,EAAGjC,EAAI,EAAGyB,EAAIwB,UAAUC,OAAQlD,EAAIyB,EAAGzB,IAE5C,IAAK,IAAIgC,KADTC,EAAIgB,UAAUjD,GACOU,OAAOoB,UAAUC,eAAe5B,KAAK8B,EAAGD,KAAId,EAAEc,GAAKC,EAAED,IAE9E,OAAOd,IAEKyC,MAAM4B,KAAMtC,YAGzB,SAASwM,OAAOxN,EAAGM,GACtB,IAAIrB,EAAI,GACR,IAAK,IAAIc,KAAKC,EAAOvB,OAAOoB,UAAUC,eAAe5B,KAAK8B,EAAGD,IAAMO,EAAEyE,QAAQhF,GAAK,IAC9Ed,EAAEc,GAAKC,EAAED,IACb,GAAS,MAALC,GAAqD,mBAAjCvB,OAAOgP,sBACtB,KAAI1P,EAAI,EAAb,IAAgBgC,EAAItB,OAAOgP,sBAAsBzN,GAAIjC,EAAIgC,EAAEkB,OAAQlD,IAC3DuC,EAAEyE,QAAQhF,EAAEhC,IAAM,GAAKU,OAAOoB,UAAU6N,qBAAqBxP,KAAK8B,EAAGD,EAAEhC,MACvEkB,EAAEc,EAAEhC,IAAMiC,EAAED,EAAEhC,KAE1B,OAAOkB,EAGJ,SAAS0O,WAAWC,EAAYC,EAAQvO,EAAKwO,GAChD,IAA2HzP,EAAvHD,EAAI4C,UAAUC,OAAQpC,EAAIT,EAAI,EAAIyP,EAAkB,OAATC,EAAgBA,EAAOrP,OAAOsP,yBAAyBF,EAAQvO,GAAOwO,EACrH,GAAuB,iBAAZE,SAAoD,mBAArBA,QAAQC,SAAyBpP,EAAImP,QAAQC,SAASL,EAAYC,EAAQvO,EAAKwO,QACpH,IAAK,IAAI/P,EAAI6P,EAAW3M,OAAS,EAAGlD,GAAK,EAAGA,KAASM,EAAIuP,EAAW7P,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEwP,EAAQvO,EAAKT,GAAKR,EAAEwP,EAAQvO,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAemP,EAAQvO,EAAKT,GAAIA,EAGzD,SAASqP,QAAQC,EAAYC,GAChC,OAAO,SAAUP,EAAQvO,GAAO8O,EAAUP,EAAQvO,EAAK6O,IAGpD,SAASE,WAAWC,EAAaC,GACpC,GAAuB,iBAAZP,SAAoD,mBAArBA,QAAQQ,SAAyB,OAAOR,QAAQQ,SAASF,EAAaC,GAG7G,SAASE,UAAUC,EAASC,EAAYC,EAAGC,GAE9C,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,UAAUjQ,GAAS,IAAMkQ,KAAKL,EAAUrO,KAAKxB,IAAW,MAAOsB,GAAK0O,EAAO1O,IACpF,SAAS6O,SAASnQ,GAAS,IAAMkQ,KAAKL,EAAiB,MAAE7P,IAAW,MAAOsB,GAAK0O,EAAO1O,IACvF,SAAS4O,KAAKzK,GAAUA,EAAOhE,KAAOsO,EAAQtK,EAAOzF,OAJzD,SAASoQ,MAAMpQ,GAAS,OAAOA,aAAiB4P,EAAI5P,EAAQ,IAAI4P,GAAE,SAAUG,GAAWA,EAAQ/P,MAI7BoQ,CAAM3K,EAAOzF,OAAOqQ,KAAKJ,UAAWE,UAClGD,MAAML,EAAYA,EAAUnN,MAAMgN,EAASC,GAAc,KAAKnO,WAI/D,SAAS8O,YAAYZ,EAASa,GACjC,IAAsGC,EAAGC,EAAGxQ,EAAGyQ,EAA3GC,EAAI,CAAEC,MAAO,EAAGC,KAAM,WAAa,GAAW,EAAP5Q,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAO6Q,KAAM,GAAIC,IAAK,IAChG,OAAOL,EAAI,CAAElP,KAAMwP,KAAK,GAAI,MAASA,KAAK,GAAI,OAAUA,KAAK,IAAwB,mBAAXlR,SAA0B4Q,EAAE5Q,OAAOuB,UAAY,WAAa,OAAOiD,OAAUoM,EACvJ,SAASM,KAAKxQ,GAAK,OAAO,SAAUyQ,GAAK,OACzC,SAASf,KAAKgB,GACV,GAAIV,EAAG,MAAM,IAAIrM,UAAU,mCAC3B,KAAOwM,GAAG,IACN,GAAIH,EAAI,EAAGC,IAAMxQ,EAAY,EAARiR,EAAG,GAAST,EAAU,OAAIS,EAAG,GAAKT,EAAS,SAAOxQ,EAAIwQ,EAAU,SAAMxQ,EAAEf,KAAKuR,GAAI,GAAKA,EAAEjP,SAAWvB,EAAIA,EAAEf,KAAKuR,EAAGS,EAAG,KAAKzP,KAAM,OAAOxB,EAE3J,OADIwQ,EAAI,EAAGxQ,IAAGiR,EAAK,CAAS,EAARA,EAAG,GAAQjR,EAAED,QACzBkR,EAAG,IACP,KAAK,EAAG,KAAK,EAAGjR,EAAIiR,EAAI,MACxB,KAAK,EAAc,OAAXP,EAAEC,QAAgB,CAAE5Q,MAAOkR,EAAG,GAAIzP,MAAM,GAChD,KAAK,EAAGkP,EAAEC,QAASH,EAAIS,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKP,EAAEI,IAAII,MAAOR,EAAEG,KAAKK,MAAO,SACxC,QACI,KAAMlR,EAAI0Q,EAAEG,MAAM7Q,EAAIA,EAAEgC,OAAS,GAAKhC,EAAEA,EAAEgC,OAAS,KAAkB,IAAViP,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAEP,EAAI,EAAG,SACjG,GAAc,IAAVO,EAAG,MAAcjR,GAAMiR,EAAG,GAAKjR,EAAE,IAAMiR,EAAG,GAAKjR,EAAE,IAAM,CAAE0Q,EAAEC,MAAQM,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYP,EAAEC,MAAQ3Q,EAAE,GAAI,CAAE0Q,EAAEC,MAAQ3Q,EAAE,GAAIA,EAAIiR,EAAI,MAC7D,GAAIjR,GAAK0Q,EAAEC,MAAQ3Q,EAAE,GAAI,CAAE0Q,EAAEC,MAAQ3Q,EAAE,GAAI0Q,EAAEI,IAAIrP,KAAKwP,GAAK,MACvDjR,EAAE,IAAI0Q,EAAEI,IAAII,MAChBR,EAAEG,KAAKK,MAAO,SAEtBD,EAAKX,EAAKrR,KAAKwQ,EAASiB,GAC1B,MAAOrP,GAAK4P,EAAK,CAAC,EAAG5P,GAAImP,EAAI,EAAK,QAAUD,EAAIvQ,EAAI,EACtD,GAAY,EAARiR,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAElR,MAAOkR,EAAG,GAAKA,EAAG,QAAK,EAAQzP,MAAM,GArB9ByO,CAAK,CAAC1P,EAAGyQ,MAyBtD,SAASG,gBAAgB5R,EAAGL,EAAGkS,EAAGC,QAC1B/N,IAAP+N,IAAkBA,EAAKD,GAC3B7R,EAAE8R,GAAMnS,EAAEkS,GAGP,SAASE,aAAapS,EAAGN,GAC5B,IAAK,IAAIkC,KAAK5B,EAAa,YAAN4B,GAAoBlC,EAAQiC,eAAeC,KAAIlC,EAAQkC,GAAK5B,EAAE4B,IAGhF,SAAS2L,SAASlN,GACrB,IAAIwB,EAAsB,mBAAXlB,QAAyBA,OAAOuB,SAAUlC,EAAI6B,GAAKxB,EAAEwB,GAAIjC,EAAI,EAC5E,GAAII,EAAG,OAAOA,EAAED,KAAKM,GACrB,GAAIA,GAAyB,iBAAbA,EAAEyC,OAAqB,MAAO,CAC1CT,KAAM,WAEF,OADIhC,GAAKT,GAAKS,EAAEyC,SAAQzC,OAAI,GACrB,CAAEQ,MAAOR,GAAKA,EAAET,KAAM0C,MAAOjC,KAG5C,MAAM,IAAI2E,UAAUnD,EAAI,0BAA4B,mCAGjD,SAASI,OAAO5B,EAAGgB,GACtB,IAAIrB,EAAsB,mBAAXW,QAAyBN,EAAEM,OAAOuB,UACjD,IAAKlC,EAAG,OAAOK,EACf,IAAmBK,EAAYyB,EAA3BvC,EAAII,EAAED,KAAKM,GAAO+B,EAAK,GAC3B,IACI,WAAc,IAANf,GAAgBA,KAAM,MAAQX,EAAId,EAAEyC,QAAQC,MAAMF,EAAGG,KAAK7B,EAAEG,OAExE,MAAO2B,GAASL,EAAI,CAAEK,MAAOA,GAC7B,QACI,IACQ9B,IAAMA,EAAE4B,OAAStC,EAAIJ,EAAU,SAAII,EAAED,KAAKH,GAElD,QAAU,GAAIuC,EAAG,MAAMA,EAAEK,OAE7B,OAAOJ,EAGJ,SAAS+M,WACZ,IAAK,IAAI/M,EAAK,GAAIxC,EAAI,EAAGA,EAAIiD,UAAUC,OAAQlD,IAC3CwC,EAAKA,EAAGa,OAAOhB,OAAOY,UAAUjD,KACpC,OAAOwC,EAGJ,SAASiQ,iBACZ,IAAK,IAAIxQ,EAAI,EAAGjC,EAAI,EAAG0S,EAAKzP,UAAUC,OAAQlD,EAAI0S,EAAI1S,IAAKiC,GAAKgB,UAAUjD,GAAGkD,OACxE,IAAIpC,EAAIqC,MAAMlB,GAAIqQ,EAAI,EAA3B,IAA8BtS,EAAI,EAAGA,EAAI0S,EAAI1S,IACzC,IAAK,IAAIoN,EAAInK,UAAUjD,GAAI2S,EAAI,EAAGC,EAAKxF,EAAElK,OAAQyP,EAAIC,EAAID,IAAKL,IAC1DxR,EAAEwR,GAAKlF,EAAEuF,GACjB,OAAO7R,EAGJ,SAAS+R,QAAQX,GACpB,OAAO3M,gBAAgBsN,SAAWtN,KAAK2M,EAAIA,EAAG3M,MAAQ,IAAIsN,QAAQX,GAG/D,SAASY,iBAAiBnC,EAASC,EAAYE,GAClD,IAAK/P,OAAOgS,cAAe,MAAM,IAAI3N,UAAU,wCAC/C,IAAoDpF,EAAhD2R,EAAIb,EAAUnN,MAAMgN,EAASC,GAAc,IAAQoC,EAAI,GAC3D,OAAOhT,EAAI,GAAIiS,KAAK,QAASA,KAAK,SAAUA,KAAK,UAAWjS,EAAEe,OAAOgS,eAAiB,WAAc,OAAOxN,MAASvF,EACpH,SAASiS,KAAKxQ,GAASkQ,EAAElQ,KAAIzB,EAAEyB,GAAK,SAAUyQ,GAAK,OAAO,IAAInB,SAAQ,SAAU3D,EAAGnI,GAAK+N,EAAErQ,KAAK,CAAClB,EAAGyQ,EAAG9E,EAAGnI,IAAM,GAAKgO,OAAOxR,EAAGyQ,QAC9H,SAASe,OAAOxR,EAAGyQ,GAAK,KACxB,SAASf,KAAKrQ,GAAKA,EAAEG,iBAAiB4R,QAAU9B,QAAQC,QAAQlQ,EAAEG,MAAMiR,GAAGZ,KAAK4B,QAASjC,QAAUkC,OAAOH,EAAE,GAAG,GAAIlS,GADrFqQ,CAAKQ,EAAElQ,GAAGyQ,IAAO,MAAO3P,GAAK4Q,OAAOH,EAAE,GAAG,GAAIzQ,IAE3E,SAAS2Q,QAAQjS,GAASgS,OAAO,OAAQhS,GACzC,SAASgQ,OAAOhQ,GAASgS,OAAO,QAAShS,GACzC,SAASkS,OAAO1B,EAAGS,GAAST,EAAES,GAAIc,EAAEI,QAASJ,EAAE9P,QAAQ+P,OAAOD,EAAE,GAAG,GAAIA,EAAE,GAAG,KAGzE,SAASK,iBAAiB5S,GAC7B,IAAIT,EAAGgC,EACP,OAAOhC,EAAI,GAAIiS,KAAK,QAASA,KAAK,SAAS,SAAU1P,GAAK,MAAMA,KAAO0P,KAAK,UAAWjS,EAAEe,OAAOuB,UAAY,WAAc,OAAOiD,MAASvF,EAC1I,SAASiS,KAAKxQ,EAAGgQ,GAAKzR,EAAEyB,GAAKhB,EAAEgB,GAAK,SAAUyQ,GAAK,OAAQlQ,GAAKA,GAAK,CAAEf,MAAO4R,QAAQpS,EAAEgB,GAAGyQ,IAAKxP,KAAY,WAANjB,GAAmBgQ,EAAIA,EAAES,GAAKA,GAAOT,GAGxI,SAAS6B,cAAc7S,GAC1B,IAAKM,OAAOgS,cAAe,MAAM,IAAI3N,UAAU,wCAC/C,IAAiCpF,EAA7BI,EAAIK,EAAEM,OAAOgS,eACjB,OAAO3S,EAAIA,EAAED,KAAKM,IAAMA,EAAqCkN,SAASlN,GAA2BT,EAAI,GAAIiS,KAAK,QAASA,KAAK,SAAUA,KAAK,UAAWjS,EAAEe,OAAOgS,eAAiB,WAAc,OAAOxN,MAASvF,GAC9M,SAASiS,KAAKxQ,GAAKzB,EAAEyB,GAAKhB,EAAEgB,IAAM,SAAUyQ,GAAK,OAAO,IAAInB,SAAQ,SAAUC,EAASC,IACvF,SAASkC,OAAOnC,EAASC,EAAQ3Q,EAAG4R,GAAKnB,QAAQC,QAAQkB,GAAGZ,MAAK,SAASY,GAAKlB,EAAQ,CAAE/P,MAAOiR,EAAGxP,KAAMpC,MAAS2Q,IADJkC,CAAOnC,EAASC,GAA7BiB,EAAIzR,EAAEgB,GAAGyQ,IAA8BxP,KAAMwP,EAAEjR,YAI7I,SAASsS,qBAAqBC,EAAQC,GAEzC,OADI/S,OAAOC,eAAkBD,OAAOC,eAAe6S,EAAQ,MAAO,CAAEvS,MAAOwS,IAAiBD,EAAOC,IAAMA,EAClGD,EAGJ,SAASE,aAAahO,GACzB,GAAIA,GAAOA,EAAItE,WAAY,OAAOsE,EAClC,IAAIgB,EAAS,GACb,GAAW,MAAPhB,EAAa,IAAK,IAAI4M,KAAK5M,EAAShF,OAAOqB,eAAe5B,KAAKuF,EAAK4M,KAAI5L,EAAO4L,GAAK5M,EAAI4M,IAE5F,OADA5L,EAAOiN,QAAUjO,EACVgB,EAGJ,SAASjB,gBAAgBC,GAC5B,OAAQA,GAAOA,EAAItE,WAAcsE,EAAM,CAAEiO,QAASjO,GAG/C,SAASkO,uBAAuBC,EAAUC,GAC7C,IAAKA,EAAWzM,IAAIwM,GAChB,MAAM,IAAIzO,UAAU,kDAExB,OAAO0O,EAAWjT,IAAIgT,GAGnB,SAASE,uBAAuBF,EAAUC,EAAY7S,GACzD,IAAK6S,EAAWzM,IAAIwM,GAChB,MAAM,IAAIzO,UAAU,kDAGxB,OADA0O,EAAW3N,IAAI0N,EAAU5S,GAClBA,I,6BCvNX,IACQ8D,EADJC,GACID,EAAgB,SAAS,cAACzE,EAAG2E,GAI7B,OAHAF,EAAgBrE,OAAOwE,gBAClB,CAAEC,UAAW,cAAgBhC,OAAS,SAAU7C,EAAG2E,GAAK3E,EAAE6E,UAAYF,IACvE,SAAU3E,EAAG2E,GAAK,IAAK,IAAIjD,KAAKiD,EAAOvE,OAAOoB,UAAUC,eAAe5B,KAAK8E,EAAGjD,KAAI1B,EAAE0B,GAAKiD,EAAEjD,MAC3E1B,EAAG2E,IAErB,SAAU3E,EAAG2E,GAChB,GAAiB,mBAANA,GAA0B,OAANA,EAC3B,MAAM,IAAIG,UAAU,uBAAyBC,OAAOJ,GAAK,iCAE7D,SAASK,KAAOC,KAAKC,YAAclF,EADnCyE,EAAczE,EAAG2E,GAEjB3E,EAAEwB,UAAkB,OAANmD,EAAavE,OAAOY,OAAO2D,IAAMK,GAAGxD,UAAYmD,EAAEnD,UAAW,IAAIwD,MAGnFG,gBAAoD,SAAUC,GAC9D,OAAQA,GAAOA,EAAItE,WAAcsE,EAAM,CAAE,QAAWA,IAExD5F,EAAQsB,YAAa,EACrB,IACI8H,EAA2B,SAAUnD,GAErC,SAASmD,0BACL,OAAkB,OAAXnD,GAAmBA,EAAOpC,MAAM4B,KAAMtC,YAAcsC,KAQ/D,OAVAP,EAAUkE,wBAAyBnD,GAInCmD,wBAAwBpH,UAAUqE,IAAM,SAAU5E,EAAKN,GACnD,GAAiC,yCAA7BA,EAAMoJ,mBACN,MAAM,IAAIzG,MAAM,kDAEpB,OAAOmC,EAAOjE,UAAUqE,IAAIhG,KAAKoF,KAAMhE,EAAKN,IAEzCiI,wBAXoB,CADHzD,gBAAgBG,EAAQ,KAalD,SACF9F,EAAA,QAAqBoJ,G,wCCjCjB8K,E,qECDW,MAAMC,OACnB,6BAA6BrS,EAAQsS,EAAMC,EAAO,IAChD,IAAIC,EACAC,EACAC,EACArT,EACA4K,EACA3I,EAEJ,GAAIgR,GAWF,GAVAI,EAAWJ,EAAKlN,QAAQ,MAEN,IAAdsN,EACFF,EAAeF,GAEfE,EAAeF,EAAK9Q,MAAM,EAAGkR,GAC7BD,EAAYH,EAAK9Q,MAAMkR,EAAW,IAGpCrT,EAAQW,EAAOwS,GACXnT,QACF,GAAMoT,GAA+B,iBAAVpT,GAAuC,iBAAVA,EAEjD,GAA8C,mBAA1CP,OAAOoB,UAAUyS,SAASpU,KAAKc,GACxC,IAAK4K,EAAQ,EAAG3I,EAASjC,EAAMiC,OAAQ2I,EAAQ3I,EAAQ2I,IACrDoI,OAAOO,sBAAsBvT,EAAM4K,GAAQwI,EAAWF,QAE/CE,GACTJ,OAAOO,sBAAsBvT,EAAOoT,EAAWF,QAN/CA,EAAKxR,KAAK1B,QAUdkT,EAAKxR,KAAKf,GAGZ,OAAOuS,GCjCI,MAAM,wBACnB,YAAYM,EAAW,GAAI3K,EAAO,GAAIE,EAAU,IACxC7G,MAAMuR,QAAQ5K,KAClBE,EAAUF,EACVA,EAAO,IAGTvE,KAAKkP,SAAWA,EAChBlP,KAAKuE,KAAOA,EACZvE,KAAKyE,QAAUtJ,OAAOgH,OAAO,CAC3BiN,eAAe,EACfxH,MAAM,GACLnD,GAGL,OAAOzB,EAAQ,IACb,GAAc,KAAVA,EACF,OAAOhD,KAAKkP,SAGd,MAAMG,EAAU,GAEhB,IAAK,IAAI5U,EAAI,EAAGA,EAAIuF,KAAKkP,SAASvR,OAAQlD,IAAK,CAC7C,MAAMwG,EAAOjB,KAAKkP,SAASzU,GAE3B,GAAyB,IAArBuF,KAAKuE,KAAK5G,OAAc,CAC1B,MAAM2R,EAAQ,wBAAYC,QAAQtO,EAAM+B,EAAOhD,KAAKyE,QAAQ2K,eAExDE,GACFD,EAAQjS,KAAK,CAAE6D,OAAMqO,eAGvB,IAAK,IAAInD,EAAI,EAAGA,EAAInM,KAAKuE,KAAK5G,OAAQwO,IAAK,CACzC,MAAMqD,EAAiBd,OAAOO,sBAAsBhO,EAAMjB,KAAKuE,KAAK4H,IAEpE,IAAIsD,GAAQ,EAEZ,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAe7R,OAAQ+R,IAAK,CAC9C,MAAMJ,EAAQ,wBAAYC,QAAQC,EAAeE,GAAI1M,EAAOhD,KAAKyE,QAAQ2K,eAEzE,GAAIE,EAAO,CACTG,GAAQ,EAERJ,EAAQjS,KAAK,CAAE6D,OAAMqO,UAErB,OAIJ,GAAIG,EACF,OAUR,OAJIzP,KAAKyE,QAAQmD,MACfyH,EAAQzH,KAAK,CAACC,EAAGnI,IAAMmI,EAAEyH,MAAQ5P,EAAE4P,OAG9BD,EAAQxN,IAAIV,GAAUA,EAAOF,MAGtC,eAAeA,EAAM+B,EAAOoM,GAC1BnO,EAAOnB,OAAOmB,GACd+B,EAAQlD,OAAOkD,GAEToM,IACJnO,EAAOA,EAAK0O,oBACZ3M,EAAQA,EAAM2M,qBAGhB,MAAMC,EAAU,wBAAYC,kBAAkB5O,EAAM+B,GAEpD,QAAM4M,IAKF3O,IAAS+B,EACJ,EAIL4M,EAAQjS,OAAS,EACPiS,EAAQA,EAAQjS,OAAS,GAAKiS,EAAQ,GAA3C,EAIF,EAAIA,EAAQ,IAGrB,yBAAyB3O,EAAM+B,GAC7B,MAAM8M,EAAU9M,EAAM+M,MAAM,IAC5B,IAAIH,EAAU,GA4Bd,OA1B6B,wBAAYI,qBAAqB/O,EAAM+B,GAE/CrB,QAAQ,CAACsO,EAAeC,KAC3C,IAAI5J,EAAQ2J,EAAgB,EAE5BL,EAAQM,GAAgB,CAACD,GAEzB,IAAK,IAAIxV,EAAI,EAAGA,EAAIqV,EAAQnS,OAAQlD,IAAK,CACvC,MAAM0V,EAASL,EAAQrV,GAIvB,GAFA6L,EAAQrF,EAAKQ,QAAQ0O,EAAQ7J,IAEd,IAAXA,EAAc,CAChBsJ,EAAQM,IAAgB,EAExB,MAGFN,EAAQM,GAAc9S,KAAKkJ,GAE3BA,OAIJsJ,EAAUA,EAAQpO,OAAO4O,IAAmC,IAAlBA,KAEpCR,EAAQjS,QAIPiS,EAAQhI,KAAK,CAACC,EAAGnI,IACL,IAAbmI,EAAElK,OACGkK,EAAE,GAAKnI,EAAE,IAGlBmI,EAAIA,EAAEA,EAAElK,OAAS,GAAKkK,EAAE,KACxBnI,EAAIA,EAAEA,EAAE/B,OAAS,GAAK+B,EAAE,KAGvB,GAGL,4BAA4BuB,EAAM+B,GAChC,MAAM4D,EAAQ5D,EAAM,GAEpB,OAAO/B,EAAK8O,MAAM,IAAIlO,IAAI,CAACsO,EAAQ7J,IAC7B6J,IAAWvJ,GAIRN,GACN9E,OAAO8E,IAAmB,IAAVA,IFvIvB,SAAS+J,MAAM3U,EAAO4U,EAAKC,GACvB,OAAOC,KAAKD,IAAID,EAAKE,KAAKF,IAAIC,EAAK7U,IAEvC,SAAS+U,wBAAwBC,EAAsBC,EAAYC,GAE/D,MAAMC,EAAoB1V,OAAO2V,OAAOF,GAAUpP,OAAQuP,GAAYA,EAAQC,WAAaN,GAC3F,IAAKC,EACD,OAAOE,EAAkBhP,IAAKkP,GAAYA,EAAQ3O,IAEtD,MAGM6O,EAHW,IAAI,wBAAYJ,EAAmB,CAAC,QAAS,CAC1DjJ,MAAM,IAEwBsJ,OAAOP,GAEzC,MAAO,IACA,IAAIQ,IAAI,IACJF,EAAiBpP,IAAKkP,GAAYA,EAAQ3O,OAC1CyO,EAAkBrP,OAAQuP,GAAYA,EAAQhO,kBAAkBlB,IAAKkP,GAAYA,EAAQ3O,QA7BxG,SAAWqM,GACPA,EAAQA,EAAsB,aAAI,GAAK,eACvCA,EAAQA,EAA6B,oBAAI,GAAK,sBAC9CA,EAAQA,EAAiC,wBAAI,GAAK,0BAClDA,EAAQA,EAAgB,OAAI,GAAK,SACjCA,EAAQA,EAAsB,aAAI,GAAK,eACvCA,EAAQA,EAA4B,mBAAI,GAAK,qBAC7CA,EAAQA,EAAuB,cAAI,GAAK,gBACxCA,EAAQA,EAAyB,gBAAI,GAAK,kBAC1CA,EAAQA,EAA0B,iBAAI,GAAK,mBAC3CA,EAAQA,EAAoB,WAAI,GAAK,aAVzC,CAWGA,IAAYA,EAAU,KAsBzB,MAAM2C,kBAAoB,CAACzS,EAAOC,KAE9B,MAAMyS,EAAqB1S,EAAM+R,qBAAuB/R,EAAMiS,SAASjS,EAAM+R,sBAAsBM,SAAW,KAC9G,OAAQpS,EAAO0S,MACX,KAAK7C,EAAQ8C,aACT,MAAO,IACA5S,EACHgS,WAAY,GACZa,gBAAiB,EACjBC,oBAAqBhB,wBAAwB9R,EAAM+R,qBAAsB,GAAI/R,EAAMiS,UACnFzP,OAAQ,MAEhB,KAAKsN,EAAQiD,oBACT,MAAO,IACA/S,EACHgT,UAAU,EACVH,gBAAiB7S,EAAMgT,SACjBtB,MAAM1R,EAAM6S,gBAAkB,EAAG,EAAG7S,EAAM8S,oBAAoB9T,OAAS,GACvE,GAEd,KAAK8Q,EAAQmD,wBACT,MAAO,IACAjT,EACH6S,gBAAiBnB,MAAM1R,EAAM6S,gBAAkB,EAAG,EAAG7S,EAAM8S,oBAAoB9T,OAAS,IAEhG,KAAK8Q,EAAQoD,OAET,OAAOlT,EAAMwC,OACP,IACKxC,EACHwC,OAAQ,MAEVxC,EAAMgS,WACF,IACKhS,EACHgS,WAAY,GACZa,gBAAiB,EACjBC,oBAAqBhB,wBAAwB9R,EAAM+R,qBAAsB,GAAI/R,EAAMiS,WAErF,IACKjS,EACH+R,qBAAsBW,EACtBI,oBAAqBhB,wBAAwBY,EAAoB,GAAI1S,EAAMiS,WAE3F,KAAKnC,EAAQqD,mBACT,MAAO,IACAnT,EACH6S,gBAAiB,EACjBd,qBAAsB,KACtBe,oBAAqBhB,wBAAwBY,EAAoB,GAAI1S,EAAMiS,UAC3EzP,OAAQ,MAEhB,KAAKsN,EAAQsD,aACT,MAAO,IACApT,EACHgS,WAAY,GACZa,gBAAiB,EACjBd,qBAAsB9R,EAAOoT,UAC7BP,oBAAqBhB,wBAAwB7R,EAAOoT,UAAW,GAAIrT,EAAMiS,UACzEzP,OAAQ,MAEhB,KAAKsN,EAAQwD,cACT,MAAO,IACAtT,EACHgT,UAAU,EACVhB,WAAY/R,EAAOsT,SACnBV,gBAAiB,EACjBC,oBAAqBhB,wBAAwB9R,EAAM+R,qBAAsB9R,EAAOsT,SAAUvT,EAAMiS,WAGxG,KAAKnC,EAAQ0D,gBACT,MAAO,IACAxT,EACHyT,iBAAkBxT,EAAOoT,UACzBK,sBAAuBzT,EAAOsT,UAGtC,KAAKzD,EAAQ6D,iBACT,MAAO,IACA3T,EACHyT,iBAAkB,KAClBC,sBAAuB,MAG/B,KAAK5D,EAAQ8D,WACT,MAAO,IACA5T,EACHwC,OAAQ,IACDvC,EAAOuC,SAItB,QACI,MAAM,IAAI9C,MAAM,kBAAkBO,EAAO0S,Q,YGzHtC,aAJF,EAAGxO,OAAM0P,QAAO,KACjB,gBAAoB,OAAQ,CAAEC,UAAW,YAC7C,gBAAoB,OAAU,CAAE3P,KAAMA,EAAM0P,KAAMA,M,OCkB3C,sCApBU,EAAGE,gBAAeC,iBAAgBN,2BAC/C,gBAAoB,SAAU,CAAEI,UAAW,oBAC/CE,EAAkB,gBAAoB,OAAQ,CAAEF,UAAW,YACvD,gBAAoB,EAAM,CAAE3P,KAAM,eAAgB0P,MAAM,IACxD,gBAAoB,KAAM,KACtBG,EAAe3X,KACf,MACAqX,IAA2BK,EAAiB,gBAAoB,OAAQ,CAAED,UAAW,cACzF,gBAAoB,EAAM,CAAE3P,KAAM4P,EAAc5P,OAChD,gBAAoB,QAAS,KAAM4P,EAAc1X,OAAW,gBAAoB,EAAM,CAAE8H,KAAM,SAClG,gBAAoB,IAAK,CAAE8P,KAAM,oBAAqBC,MAAO,qCAAsCtI,OAAQ,SAAUuI,IAAK,sBAAuBL,UAAW,gBACxJ,gBAAoB,QAAS,KAAM,qBACnC,gBAAoB,MAAO,CAAEM,MAAO,6BAA8BC,MAAO,KAAMC,OAAQ,KAAMC,QAAS,eAClG,gBAAoB,OAAQ,KACxB,gBAAoB,iBAAkB,CAAE9Q,GAAI,IAAK+Q,cAAe,iBAAkBC,GAAI,SAAUC,GAAI,UAAWC,GAAI,UAAWC,GAAI,WAC9H,gBAAoB,OAAQ,CAAEC,OAAQ,IAAKC,UAAW,YACtD,gBAAoB,OAAQ,CAAED,OAAQ,IAAKC,UAAW,cAC9D,gBAAoB,OAAQ,CAAE1Y,EAAG,iFAAkF2Y,KAAM,YACzH,gBAAoB,OAAQ,CAAE3Y,EAAG,gFAAiF2Y,KAAM,UAAWC,UAAW,oC,QCL/I,wBAbG,EAAGhD,aAAYiD,eAC7B,MAAMC,EAAW,mBACXC,EAAiB,sBAAa9W,IAElB,WAAVA,EAAEhB,KACE6X,EAASE,QAAQrY,QACjBsB,EAAEgX,iBACFhX,EAAEiX,oBAGX,CAACJ,EAASE,UACb,OAAQ,gBAAoB,QAAS,CAAEG,IAAKL,EAAUpB,UAAW,YAAkBnB,KAAM,SAAU6C,YAAa,uBAA6BC,WAAW,EAAMR,SAAUA,EAAUS,QAASP,EAAgBpY,MAAOiV,K,QCHvM,sCANU,EAAGD,uBAAsBC,aAAY2D,WAAUC,kBAC5D,IAAMC,cAAc,SAAU,CAAE/B,UAAW,oBAC/C/B,GAAyB,IAAM8D,cAAc,SAAU,CAAElD,KAAM,SAAUmD,QAAS,IAAMH,EAAS,CAAEhD,KAAM7C,EAAQqD,qBAAuBW,UAAW,cAC/I,IAAM+B,cAAc,EAAM,CAAE1R,KAAM,gBACtC,IAAM0R,cAAc,oBAAW,CAAE7D,WAAYA,EAAYiD,SAAUW,K,eCN3E,MAAMG,EAAkB,IAAMC,WAAW,EAAG5D,UAAS6D,eAAcC,cAAazC,oBAAoB8B,KAChG,MAAM,GAAE9R,EAAE,KAAEpH,EAAI,YAAEyF,EAAW,KAAEqC,GAASiO,EACxC,OAAQ,IAAMyD,cAAc,KAAM,CAAE/B,UAAW,CAAC,kBAAwBoC,GAAe,eAAoBC,KAAK,KAAML,QAAS,IAAMG,EAAaxS,GAAK8R,IAAKA,GACxJ,IAAMM,cAAc,EAAM,CAAE1R,KAAMA,IAClC,IAAM0R,cAAc,OAAQ,CAAE/B,UAAW,SACrC,IAAM+B,cAAc,OAAQ,KAAMxZ,GAClCyF,GAAe,IAAM+T,cAAc,QAAS,KAA4B,iBAAf/T,EAA0BA,EAAcA,SAE7GiU,EAAgBK,YAAc,kBAEf,UAAMC,KAAKN,EAAiB,CAACO,EAAM/X,IACtC+X,EAAKlE,QAAQ3O,KAAOlF,EAAK6T,QAAQ3O,IAAM6S,EAAKf,MAAQhX,EAAKgX,KAAOe,EAAK7C,mBAAqBlV,EAAKkV,kBCD5F,UAAM4C,KAVE,EAAGpE,WAAUa,sBAAqBD,kBAAiB0D,mBAAkBC,UAAU,WAAY/C,mBAAmB,GAAIgD,oBAAoB,iCACzJ,MAAMC,EAAqB,IAAMC,OAAO,MAKxC,OAJA,oBAAU,KACN,IAAItX,EACkC,QAArCA,EAAKqX,EAAmBtB,eAA4B,IAAP/V,GAAyBA,EAAGuX,eAAe,CAAEC,SAAU,SAAUC,MAAO,aACvH,CAACJ,EAAmBtB,UACf,IAAMS,cAAc,MAAO,CAAE/B,UAAW,WAC5C0C,GAAW,IAAMX,cAAc,KAAM,KAAMW,GAC3C1D,EAAoB9T,OAAS,EAAK,IAAM6W,cAAc,KAAM,KAAM/C,EAAoB5P,IAAI,CAACmQ,EAAW1L,IAAW,IAAMkO,cAAc,EAAiB,CAAExY,IAAKgW,EAAWkC,IAAK1C,IAAoBlL,EAAQ+O,EAAqB,KAAMtE,QAASH,EAASoB,GAAY4C,aAAcM,EAAkBL,YAAarD,IAAoBlL,EAAO8L,iBAAkBA,MAA2B,IAAMoC,cAAc,QAAS,CAAE/B,UAAW,aAAoB2C,MCPtb,SAASM,gBAAgB9E,EAAUI,EAAW,MACjD,OAAO7V,OAAOoJ,KAAKqM,GAAU+E,OAAO,CAACC,EAAa5D,KAC9C,MAAM,KAAElP,EAAI,YAAErC,EAAW,KAAEzF,EAAI,YAAE6a,EAAW,OAAEjX,EAAM,iBAAEmE,GAAqB6N,EAASoB,GAE9E8D,EAAoB9E,EAAW,GAAGA,KAAYgB,IAAcA,EAE5D+D,EAAgBF,EAChB1a,OAAOoJ,KAAKsR,GAAahU,IAAKmU,GAAiB,GAAGF,KAAqBE,KACvE,GAaN,OAXAJ,EAAYE,GAAqB,CAC7B1T,GAAI0T,EACJ9a,OACA8H,OACArC,cACA7B,SACAmE,mBACAgT,gBACA/E,YAGA+E,EAAcpY,OAAS,EAChB,IACAiY,KACAF,gBAAgBG,EAAaC,IAGjCF,GACR,I,YCZQ,UAAMZ,KAjBM,EAAG7T,aAC1B,MAAM,QAAEsD,EAAO,KAAEwR,EAAI,QAAEC,GAAY/U,EAC7B+T,EAAmB,sBAAalD,IAClC,MAAM,OAAEpT,GAAW6F,EAAQuN,GACtBpT,IAEgB,iBAAVA,GAIXsC,QAAQiV,MAAM,gCAAiCnE,GAC/CpT,KAJIT,OAAOiY,SAASxD,KAAOhU,IAK5B,CAAC6F,IACJ,OAAQ,IAAM+P,cAAc,MAAO,CAAE/B,UAAW,sBAC5CwD,EAAO,IAAMzB,cAAc,MAAO,KAAMyB,GAAQ,GAChDxR,GAAY,IAAM+P,cAAc,EAAgB,CAAEW,QAASe,EAAStF,SAAUnM,EAASgN,oBAAqBtW,OAAOoJ,KAAKE,GAAU+M,gBAAiB,EAAG0D,iBAAkBA,EAAkBE,kBAAmB,kDCVrN,MAAMiB,EAAe,CACjB1E,UAAU,EACVjB,qBAAsB,KACtBe,oBAAqB,GACrBd,WAAY,GACZa,gBAAiB,EACjBZ,SAAU,GACVwB,iBAAkB,KAClBC,sBAAuB,KACvBlR,OAAQ,MAOZ,SAASmV,oBAAoBC,GACzB,MAAMC,EAAQ,iBAAOD,GAErB,OADAC,EAAMzC,QAAUwC,EACTC,EAsHI,mBApHI,EAAG5F,WAAU5R,OAAMyX,iBAClC,MAAO9X,EAAO2V,GAAY,qBAAWlD,kBAAmB,IACjDiF,EACHzF,SAAU8E,gBAAgB9E,GAC1Ba,oBAAqBtW,OAAOoJ,KAAKqM,KAE/B8F,EAAsBJ,oBAAqBtZ,IAC7C,GAAKgC,IAAQhC,EAAE2Z,iBAGf,GAAc,WAAV3Z,EAAEhB,IACFgB,EAAEiX,kBACFjX,EAAEgX,iBACErV,EAAM+R,sBAAwB/R,EAAMgS,WACpC2D,EAAS,CAAEhD,KAAM7C,EAAQoD,SAIzB4E,SAGH,GAAc,cAAVzZ,EAAEhB,IACPgB,EAAEiX,kBACFjX,EAAEgX,iBACFM,EAAS,CAAEhD,KAAM7C,EAAQiD,2BAExB,GAAc,YAAV1U,EAAEhB,IACPgB,EAAEiX,kBACFjX,EAAEgX,iBACFM,EAAS,CAAEhD,KAAM7C,EAAQmD,+BAExB,GAAc,UAAV5U,EAAEhB,KAAmB2C,EAAM8S,oBAAoB9T,OAASgB,EAAM6S,gBAAiB,CACpFxU,EAAEiX,kBACFjX,EAAEgX,iBACF,MAAMhC,EAAYrT,EAAM8S,oBAAoB9S,EAAM6S,iBAClD0D,EAAiBlD,MAGnBuC,EAAe,sBAAavX,IAC9BsX,EAAS,CAAEhD,KAAM7C,EAAQwD,cAAeC,SAAUlV,EAAEuN,OAAO7O,MAAMkb,iBAClE,IACG1B,EAAmB,sBAAY2B,MAAO7E,IACxC,MAAM,OAAEpT,EAAM,iBAAEmE,GAAqBpE,EAAMiS,SAASoB,GACpD,IAAKpT,EACD,OAAO0V,EAAS,CAAEhD,KAAM7C,EAAQsD,aAAcC,cAGlD,GAAqB,iBAAVpT,EAGP,OAFA0V,EAAS,CAAEhD,KAAM7C,EAAQ0D,gBAAiBH,YAAWE,SAAU,qBAC/D/T,OAAOiY,SAASxD,KAAOhU,GAG3B0V,EAAS,CAAEhD,KAAM7C,EAAQ0D,gBAAiBH,YAAWE,SAAU,oBAC/D,MAAM4E,EAAelY,EAAOmE,EAAmBpE,EAAMgS,gBAAa1R,GAClE,GAAI6X,EAAa/K,KAEb+K,EACK/K,KAAM5K,IAEPD,QAAQiV,MAAM,iBAAkBhV,KAE/B4V,MAAO1Z,IAER6D,QAAQ7D,MAAM,gBAAiBA,KAE9B2Z,QAAQ,KACT1C,EAAS,CAAEhD,KAAM7C,EAAQ6D,0BAG5B,GAAIwE,EAAa5Z,KAAM,CAExB,MAAMqO,EAAYuL,EAElB,UAAW,MAAM3V,KAAUoK,EACvB+I,EAAS,CAAEhD,KAAM7C,EAAQ0D,gBAAiBH,YAAWE,SAAU/Q,EAAO+U,UAClE/U,EAAOsD,SACP6P,EAAS,CAAEhD,KAAM7C,EAAQ8D,WAAYpR,WAG7CmT,EAAS,CAAEhD,KAAM7C,EAAQ6D,wBAGzBpR,QAAQ+V,KAAK,+CAAgDH,IAElE,CAACnY,EAAMgS,WAAYhS,EAAMiS,WACtBsG,EAAsBZ,oBAAqBtE,IAC7C,MAAM,WAAErB,GAAehS,EACvBuC,QAAQiV,MAAM,aAAcxF,GAE5BuE,EAAiBlD,KAiBrB,OAZA,oBAAU,KACN,IAAKhT,EACD,OAMJ,MAAMmY,sBAAyBna,GAAM0Z,EAAoB3C,QAAQ/W,GAEjE,OADAmB,OAAOiZ,iBAAiB,UAAWD,uBAC5B,IAAMhZ,OAAOkZ,oBAAoB,UAAWF,wBACpD,CAACnY,IACCA,EAGG,IAAMwV,cAAc,SAAU,CAAE/B,UAAW,CAAC,aAAmB9T,EAAMwC,QAAU,cAAmB2T,KAAK,KAAM9V,KAAMA,GACvH,IAAMwV,cAAc,kCAAkB,CAAE9D,qBAAsB/R,EAAM+R,qBAAsBC,WAAYhS,EAAMgS,WAAY2D,SAAUA,EAAUC,aAAcA,IAC1J,IAAMC,cAAc,MAAO,CAAE/B,UAAW,CAAC,cAAoB9T,EAAMgT,UAAY,WAAiBhT,EAAMwC,QAAU,SAAc2T,KAAK,MAC/H,IAAMN,cAAc,EAAgB,CAAE5D,SAAUjS,EAAMiS,SAAUa,oBAAqB9S,EAAM8S,oBAAqBD,gBAAiB7S,EAAM6S,gBAAiB0D,iBAAmBlD,GAAckF,EAAoBnD,QAAQ/B,GAAYI,iBAAkBzT,EAAMyT,mBACzPzT,EAAMwC,QAAU,IAAMqT,cAAc,EAAoB,CAAErT,OAAQxC,EAAMwC,UAC5ExC,EAAMgT,UAAa,IAAM6C,cAAc,kCAAkB,CAAE9B,cAAe/T,EAAM+R,qBAAuB/R,EAAMiS,SAASjS,EAAM+R,sBAAwB,KAAMiC,eAAgBhU,EAAMyT,iBAAmBzT,EAAMiS,SAASjS,EAAMyT,kBAAoB,KAAMC,sBAAuB1T,EAAM0T,yBAPxQ,M,uBCrHA,sBAjBGwE,MAAOS,EAAUC,KAC3BA,IACAD,EAAWnc,OAAOoJ,KAAKgT,GAAQ5B,OAAO,CAAC6B,EAAKxb,IACjCwb,EAAM,IAAMxb,EAAM,IAAMyb,mBAAmBF,EAAOvb,IAC1Dsb,EAAW,MAEX,yBACFI,cAAeC,IAAc,CAC9BH,IAAKF,EACLM,OAAQ,MACRC,YAAa,UACbC,QAAS,CACL,mBAAoBH,MAGvB5L,KAAMgM,GAAaA,GAAYA,EAASC,SCFjD,MAAM,8CAA2B,gBAC7B,YAAYC,GACRC,MAAMD,GACNjY,KAAKmY,yBAA2B,KAC5B,MAAM,eAAEzU,EAAc,mBAAE0U,EAAkB,OAAEC,GAAWrY,KAAKiY,MAE5D,OADgBvU,EAAexB,eAChByT,OAAO,CAAC2C,GAASlW,KAAI3B,cAAa7B,aACxCyZ,EAAO5U,QAAQjC,OAAO+W,SAASnW,KAChCkW,EAAMlW,GAAM,CACRpH,KAAMyF,EACNA,YAAa2B,EACbU,KAAM9C,KAAKwY,kBAAkBpW,GAC7BxD,OAAQiY,SAAYuB,EAAmBxZ,OAGxC0Z,GACR,KAEPtY,KAAKyY,kCAAoC,KACrC,MAAM,mBAAEC,EAAkB,iBAAEC,EAAgB,aAAEC,GAAiB5Y,KAAKiY,MACpE,OAAO9c,OAAOoJ,KAAKoU,GAAkBhD,OAAO,CAAC2C,EAAO1c,KAChD,MAAM,MAAEiX,EAAK,cAAEgG,GAAkBF,EAAiB/c,GAOlD,OANA0c,EAAM1c,GAAQ,CACVZ,KAAM4d,EAAaE,UAAUjG,GAC7BpS,YAAa,IAAOT,KAAKiY,MAAMc,kBAAoBnd,EAAO,mBAAqB,GAC/EkH,KAAM+V,EAAgB,SAAW,MACjCja,OAAQiY,SAAY6B,EAAmB9c,IAEpC0c,GACR,KAEPtY,KAAKgZ,cAAgBnC,UACjB,MAAM,QAAEoC,EAAO,aAAE/V,EAAY,uBAAEgW,EAAsB,iBAAEza,GAAqBuB,KAAKiY,MACjFxZ,IACAwa,EAAQC,GAA0BhW,EAAaK,iBAAatE,EAAW,UAE3Ee,KAAKmZ,iBAAmBtC,gBAAiB7T,GACrC,MAAM,SAAEoW,EAAQ,kCAAEC,EAAiC,0BAAEC,GAA8BtZ,KAC9EiY,WACC,CACFsB,SAAS,EACTrD,QAAS,kBAAkBlT,MAE/B,MAAMqM,QAAiB,kBA5CL,wDA4CsC,CAAErM,QAAOwW,KAAMJ,EAAS7V,cAAewI,KAAMsD,IAEjGnO,QAAQiV,MAAM,gBAAiB9G,GACxBA,IAyBX,YAvBM,CACFkK,SAAS,EACTrD,QAAY7G,EAAQ1R,OAAX,4BACT8G,QAAS4K,EAAQsG,OAAO,CAAC2C,GAAStd,OAAMye,WAAU3W,OAAMS,cAAamW,SAC5DA,GAILpB,EAAM/U,GAAe,CACjBnB,GAAImB,EACJvI,OACAyF,YAAagZ,EACb7a,OAAQiY,UACJ3V,QAAQiV,MAAM,yBAA0B5S,EAAamW,GACrDJ,EAA0BI,GAC1BL,EAAkC9V,IAEtCT,QAEGwV,GAbIA,EAcZ,KAGA,CACHiB,SAAS,EACTrD,QAAS,uBAGjBlW,KAAK2Z,cAAgB9C,UACjB,MAAM,2BAAE+C,EAA0B,cAAEC,EAAa,cAAEC,GAAkB9Z,KAAKiY,MAE1E,OADA4B,EAAcD,EAA2B/X,IAAK2X,GAASA,EAAKjW,aAAcuW,GACnE,CACHP,SAAS,EACTrD,QAAS,aAAa0D,EAA2Bjc,mBAGzDqC,KAAK+Z,iBAAmBlD,UACpB,MAAM,iBAAEmD,EAAgB,cAAEH,EAAa,cAAEC,GAAkB9Z,KAAKiY,MAEhE,OADA4B,EAAcG,EAAiBnY,IAAK2X,GAASA,EAAKjW,aAAcuW,GACzD,CACHP,SAAS,EACTrD,QAAS,aAAa8D,EAAiBrc,mBAG/CqC,KAAKia,cAAgBpD,UACjB,MAAM,2BAAE+C,EAA0B,cAAEM,GAAkBla,KAAKiY,MAE3D,OADAiC,EAAcN,EAA2B/X,IAAK2X,GAASA,EAAKjW,cACrD,CACHgW,SAAS,EACTrD,QAAS,aAAa0D,EAA2Bjc,mBAGzDqC,KAAKma,iBAAmBtD,UACpB,MAAM,iBAAEmD,EAAgB,cAAEE,GAAkBla,KAAKiY,MAEjD,OADAiC,EAAcF,EAAiBnY,IAAK2X,GAASA,EAAKjW,cAC3C,CACHgW,SAAS,EACTrD,QAAS,aAAa8D,EAAiBrc,mBAG/CqC,KAAKrB,MAAQ,CACTyb,QAAQ,EACRxJ,SAAU,CAsBNqI,QAAS,CACLje,KAAM,WACN8H,KAAM,OACNrC,YAAa,iBACb7B,OAAQoB,KAAKgZ,eAEjBqB,gBAAiB,CACbrf,KAAM,mBACN8H,KAAM,SACNrC,YAAa,mCACb7B,OAAQoB,KAAKmZ,iBAAiBld,KAAK+D,MACnC+C,kBAAkB,GAEtBuX,eAAgB,CACZtf,KAAM,6BACNyF,YAAa,6BACbqC,KAAM,QACN+S,YAAa,CACT0E,QAAS,CACLvf,KAAM,UACNyF,YAAa,mCACbqC,KAAM,QACNlE,OAAQoB,KAAK2Z,eAEjBa,WAAY,CACRxf,KAAM,cACNyF,YAAa,sBACbqC,KAAM,eACNlE,OAAQoB,KAAK+Z,kBAEjBU,QAAS,CACLzf,KAAM,UACNyF,YAAa,mCACbqC,KAAM,MACNlE,OAAQoB,KAAKia,eAEjBS,WAAY,CACR1f,KAAM,cACNyF,YAAa,sBACbqC,KAAM,MACNlE,OAAQoB,KAAKma,oBAIzBQ,aAAc,CACV3f,KAAM,gBACN8H,KAAM,WACNrC,YAAa,6BACboV,YAAa7V,KAAKmY,4BAEtByC,sBAAuB,CACnB5f,KAAM,2BACN8H,KAAM,SACNrC,YAAa,wCACboV,YAAa7V,KAAKyY,uCAKlC,kBAAkBrW,GACd,IAAIyY,EAAazY,EAAG2N,MAAM,KAAKlD,MAK/B,OAHIgO,EAAWpZ,QAAQ,WAAa,IAChCoZ,EAAa,UAETA,GACJ,IAAK,SACD,MAAO,YACX,IAAK,SACD,MAAO,OACX,IAAK,SACL,IAAK,QACD,MAAO,eACX,IAAK,QACD,MAAO,QAEf,MAAO,OAEX,oBACI,MAAM,QAAE/b,GAAYkB,KAAKiY,MAErBnZ,GACA3D,OAAOoJ,KAAKzF,GAAS6C,QAASmZ,IAC1B,IACI,MAAMC,EAAiBjc,EAAQgc,KAC/B9a,KAAKgb,SAAU/F,IAAS,CAAGrE,SAAU,IAAKqE,EAAKrE,YAAamK,MAEhE,MAAO/d,GACHkE,QAAQ7D,MAAM,oDAAoDyd,EAAc9d,MAK5F,kBAnOkB,qDAoOb+O,KAAM6E,IACP5Q,KAAKgb,SAAU/F,IAAS,CAAGmF,QAAQ,EAAMxJ,SAAU,IAAKqE,EAAKrE,YAAaA,QAEzEmG,MAAO1Z,IACR6D,QAAQ7D,MAAM,uCAAwCA,KAG9D,SACI,MAAM,eAAE+B,EAAc,iBAAEX,GAAqBuB,KAAKiY,OAC5C,SAAErH,EAAQ,OAAEwJ,GAAWpa,KAAKrB,MAClC,OAAQ,gBAAoB,MAAO,KAC/B,gBAAoB,aAAY,CAAE8V,QAAS,IAAMhW,IAAoBwc,SAAU7b,EAAgByT,MAAO,qBAAsB/P,KAAM,SAAUoY,UAAWd,IACvJA,GAAW,gBAAoB,MAAO,CAAE3H,UAAW,CAAC,kBAAwBrT,GAAkB,QAAa0V,KAAK,MAC5G,gBAAoB,eAAY,CAAE9V,KAAMI,EAAgBwR,SAAUA,EAAU6F,WAAYhY,OAGxG,sCAAmB0c,UAAY,CAC3B9C,OAAQ,IAAUhc,OAAO+e,WACzBxC,aAAc,IAAUvc,OAAO+e,WAC/BhC,SAAU,IAAU/c,OACpB6G,aAAc,IAAU7G,OACxB6c,uBAAwB,IAAUmC,OAClCjc,eAAgB,IAAUkc,KAC1B7c,iBAAkB,IAAU8c,KAAKH,WACjChD,mBAAoB,IAAUmD,KAAKH,WACnC1X,eAAgB,IAAUrH,OAAO+e,WACjCnC,QAAS,IAAUsC,KAAKH,WACxBrC,gBAAiB,IAAUsC,OAAOD,WAClC1C,mBAAoB,IAAU6C,KAAKH,WACnCzC,iBAAkB,IAAUtc,OAAO+e,WACnCpB,iBAAkB,IAAUwB,MAC5B5B,2BAA4B,IAAU4B,MACtCC,oBAAqB,IAAUH,KAC/BzB,cAAe,IAAU0B,KAAKH,WAC9BlB,cAAe,IAAUqB,KAAKH,WAC9BtB,cAAe,IAAUuB,OAAOD,WAChC/B,kCAAmC,IAAUkC,KAAKH,WAClD9B,0BAA2B,IAAUiC,KAAKH,YAE9C,MAcMM,EAA2B,eAAMjZ,IAAmB,CACtDmW,aAAcnW,EAAenH,IAAI,QACjCoI,eAAgBjB,EAAenH,IAAI,WACnC+c,OAAQ5V,EAAenH,IAAI,yBAAyBA,IAAI,mCACxDqgB,kBAAmBlZ,EAAenH,IAAI,2CACtCqd,iBAAkBlW,EAAenH,IAAI,yBAAyBA,IAAI,oBAClEwD,QAAS2D,EAAenH,IAAI,wBAAwBoG,oBAAoB,cAE7D,4BAAQ,KAAM,IAAM,CAC/BjD,iBAAkB,UAAkBA,iBACpCwa,QAAS,UAAQ9V,GAAGC,MAAMwY,iBAC1BlD,mBAAoB,UAAQmD,GAAGC,gBAAgBlb,IAC/CiZ,cAAe,UAAQ1W,GAAG4Y,WAAWxB,QACrCL,cAAe,UAAQ/W,GAAG4Y,WAAWC,gBACrC3C,kCAAmC,UAAQlW,GAAGC,MAAM6Y,gBACpD3C,0BAA2B,UAAQuC,GAAGK,cAAcC,QAPzC,CAQZ,kBA9BsBxd,IAAU,CAC/Bya,SAAU,YAAUjW,GAAGC,MAAMgZ,iBAAiBzd,GAC9CuE,aAAc,YAAUC,GAAGC,MAAMC,qBAAqB1E,GACtDua,uBAAwB,YAAU/V,GAAGC,MAAMiZ,wBAAwB1d,GACnEqb,iBAAkB,YAAU7W,GAAG4Y,WAAWO,yBAAyB3d,GACnEib,2BAA4B,YAAUzW,GAAG4Y,WAAWQ,mCAAmC5d,GACvF8c,oBAAqB,YAAUtY,GAAG4Y,WAAWS,4BAA4B7d,GACzEmb,cAAe,YAAU3W,GAAG4Y,WAAWU,sBAAsB9d,GAC7DS,eAAgB,YAAoBA,eAAeT,GACnDoa,gBAAiB,YAAU8C,GAAGC,gBAAgBY,uBAAuB/d,KAE7C2V,IAAa,CACrC8D,mBAAoB9D,IAkBrB,CAA6CoH,EAAyB","file":"Plugin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 20);\n","import readFromConsumerApi from '../../../../dist/readFromConsumerApi';\n\nmodule.exports = readFromConsumerApi('vendor')().React;\n","import readFromConsumerApi from '../../../../dist/readFromConsumerApi';\n\nmodule.exports = readFromConsumerApi('vendor')().PropTypes;\n","import readFromConsumerApi from '../../../../dist/readFromConsumerApi';\n\nmodule.exports = readFromConsumerApi('NeosProjectPackages')().NeosUiReduxStore;\n","\"use strict\";\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nexports.__esModule = true;\nfunction readFromConsumerApi(key) {\n    return function () {\n        var _a;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (window['@Neos:HostPluginAPI'] && window['@Neos:HostPluginAPI'][\"@\".concat(key)]) {\n            return (_a = window['@Neos:HostPluginAPI'])[\"@\".concat(key)].apply(_a, __spreadArray([], __read(args), false));\n        }\n        throw new Error('You are trying to read from a consumer api that hasn\\'t been initialized yet!');\n    };\n}\nexports[\"default\"] = readFromConsumerApi;\n//# sourceMappingURL=readFromConsumerApi.js.map","// extracted by mini-css-extract-plugin\nmodule.exports = {\"commandBar\":\"CommandBar-module__commandBar___3t_V0\",\"hasResults\":\"CommandBar-module__hasResults___3NzEf\",\"resultsWrap\":\"CommandBar-module__resultsWrap___ceSal\",\"expanded\":\"CommandBar-module__expanded___tNs3W\",\"split\":\"CommandBar-module__split___mpznN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"commandBarFooter\":\"CommandBarFooter-module__commandBarFooter___1mMGR\",\"breadcrumb\":\"CommandBarFooter-module__breadcrumb___2xMga\",\"activity\":\"CommandBarFooter-module__activity___1YdE7\",\"madeWithLove\":\"CommandBarFooter-module__madeWithLove___2_GKs\"};","import { createAction, handleActions } from 'redux-actions';\nexport const actionTypes = {\n    TOGGLE_COMMAND_BAR: 'TOGGLE_COMMAND_BAR',\n};\nconst toggleCommandBar = createAction(actionTypes.TOGGLE_COMMAND_BAR);\nexport const actions = {\n    toggleCommandBar,\n};\nexport const reducer = handleActions({\n    TOGGLE_COMMAND_BAR: (state, action) => {\n        var _a, _b;\n        return ({\n            ...state,\n            plugins: {\n                ...state.plugins,\n                commandBar: {\n                    open: action.payload !== undefined ? action.payload.open : !((_b = (_a = state.plugins) === null || _a === void 0 ? void 0 : _a.commandBar) === null || _b === void 0 ? void 0 : _b.open),\n                },\n            },\n        });\n    },\n}, {\n    plugins: {\n        commandBar: {\n            open: false,\n        },\n    },\n});\nexport const selectors = {\n    commandBarOpen: (state) => { var _a, _b; return (_b = (_a = state.plugins) === null || _a === void 0 ? void 0 : _a.commandBar) === null || _b === void 0 ? void 0 : _b.open; },\n};\n","import readFromConsumerApi from '../../../../dist/readFromConsumerApi';\n\nmodule.exports = readFromConsumerApi('NeosProjectPackages')().ReactUiComponents;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"commandListItem\":\"CommandListItem-module__commandListItem___PbP5Z\",\"highlighted\":\"CommandListItem-module__highlighted___ww9c6\",\"label\":\"CommandListItem-module__label___3g_nM\"};","import readFromConsumerApi from '../../../../dist/readFromConsumerApi';\n\nmodule.exports = readFromConsumerApi('vendor')().reduxActions;\n","import readFromConsumerApi from '../../../../dist/readFromConsumerApi';\n\nmodule.exports = readFromConsumerApi('vendor')().reactRedux;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"commandBarHeader\":\"CommandBarHeader-module__commandBarHeader___2UG9r\",\"backButton\":\"CommandBarHeader-module__backButton___3tZcE\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"results\":\"CommandListing-module__results___ug-oG\",\"noResults\":\"CommandListing-module__noResults___2zw8Z\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"fullScreenLayer\":\"CommandBarUiPlugin-module__fullScreenLayer___1cUx4\",\"open\":\"CommandBarUiPlugin-module__open___1Bjxj\"};","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nexports.__esModule = true;\nvar AbstractRegistry_1 = __importDefault(require(\"./AbstractRegistry\"));\nvar positional_array_sorter_1 = __importDefault(require(\"@neos-project/positional-array-sorter\"));\nvar SynchronousRegistry = (function (_super) {\n    __extends(SynchronousRegistry, _super);\n    function SynchronousRegistry(description) {\n        var _this = _super.call(this, description) || this;\n        _this._registry = [];\n        return _this;\n    }\n    SynchronousRegistry.prototype.set = function (key, value, position) {\n        if (position === void 0) { position = 0; }\n        if (typeof key !== 'string') {\n            throw new Error('Key must be a string');\n        }\n        if (typeof position !== 'string' && typeof position !== 'number') {\n            throw new Error('Position must be a string or a number');\n        }\n        var entry = { key: key, value: value };\n        if (position) {\n            entry.position = position;\n        }\n        var indexOfItemWithTheSameKey = this._registry.findIndex(function (item) { return item.key === key; });\n        if (indexOfItemWithTheSameKey === -1) {\n            this._registry.push(entry);\n        }\n        else {\n            this._registry[indexOfItemWithTheSameKey] = entry;\n        }\n        return value;\n    };\n    SynchronousRegistry.prototype.get = function (key) {\n        if (typeof key !== 'string') {\n            console.error('Key must be a string');\n            return null;\n        }\n        var result = this._registry.find(function (item) { return item.key === key; });\n        return result ? result.value : null;\n    };\n    SynchronousRegistry.prototype._getChildrenWrapped = function (searchKey) {\n        var unsortedChildren = this._registry.filter(function (item) { return item.key.indexOf(searchKey + '/') === 0; });\n        return (0, positional_array_sorter_1[\"default\"])(unsortedChildren);\n    };\n    SynchronousRegistry.prototype.getChildrenAsObject = function (searchKey) {\n        var result = {};\n        this._getChildrenWrapped(searchKey).forEach(function (item) {\n            result[item.key] = item.value;\n        });\n        return result;\n    };\n    SynchronousRegistry.prototype.getChildren = function (searchKey) {\n        return this._getChildrenWrapped(searchKey).map(function (item) { return item.value; });\n    };\n    SynchronousRegistry.prototype.has = function (key) {\n        if (typeof key !== 'string') {\n            console.error('Key must be a string');\n            return false;\n        }\n        return Boolean(this._registry.find(function (item) { return item.key === key; }));\n    };\n    SynchronousRegistry.prototype._getAllWrapped = function () {\n        return (0, positional_array_sorter_1[\"default\"])(this._registry);\n    };\n    SynchronousRegistry.prototype.getAllAsObject = function () {\n        var result = {};\n        this._getAllWrapped().forEach(function (item) {\n            result[item.key] = item.value;\n        });\n        return result;\n    };\n    SynchronousRegistry.prototype.getAllAsList = function () {\n        return this._getAllWrapped().map(function (item) { return Object.assign({ id: item.key }, item.value); });\n    };\n    return SynchronousRegistry;\n}(AbstractRegistry_1[\"default\"]));\nexports[\"default\"] = SynchronousRegistry;\n//# sourceMappingURL=SynchronousRegistry.js.map","import readFromConsumerApi from '../../../../dist/readFromConsumerApi';\n\nmodule.exports = readFromConsumerApi('NeosProjectPackages')().NeosUiDecorators;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"iconWrap\":\"Icon-module__iconWrap___1tIr6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchBox\":\"SearchBox-module__searchBox___3J8zU\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"commandResultsView\":\"CommandResultsView-module__commandResultsView___2_3i-\"};","import readFromConsumerApi from '../../../../dist/readFromConsumerApi';\n\nexport default readFromConsumerApi('NeosProjectPackages')().NeosUiBackendConnectorDefault;\n\nconst {fetchWithErrorHandling} = readFromConsumerApi('NeosProjectPackages')().NeosUiBackendConnector;\nexport {fetchWithErrorHandling};\n","require('./manifest');\n","import manifest, { SynchronousRegistry } from '@neos-project/neos-ui-extensibility';\nimport { selectors } from '@neos-project/neos-ui-redux-store';\n\nimport { reducer, actions } from './actions';\nimport CommandBarUiPlugin from './CommandBarUiPlugin';\n\nmanifest('Shel.Neos.CommandBar:CommandBar', {}, (globalRegistry, { store, frontendConfiguration }) => {\n    const { enabled } = frontendConfiguration['Shel.Neos.CommandBar:CommandBar'];\n\n    if (!enabled) {\n        return;\n    }\n\n    // Create our new registry for 3rd party command bar plugins\n    globalRegistry.set(\n        'Shel.Neos.CommandBar',\n        new SynchronousRegistry(`\n        # Shel.Neos.CommandBar 3rd party commands\n    `)\n    );\n\n    // Register test plugin command\n    globalRegistry.get('Shel.Neos.CommandBar').set('plugins/test', () => {\n        return {\n            extensibilityTest: {\n                name: 'Extensibility test',\n                icon: 'vial',\n                description: 'Command registered via command bar extensibility',\n                canHandleQueries: true,\n                action: async (query) => {\n                    const state = store.getState();\n                    const documentNode = selectors.CR.Nodes.documentNodeSelector(state);\n                    window.alert(`The current document node is ${documentNode.contextPath} and the query is ${query}.`);\n                },\n            },\n        };\n    });\n\n    // Register commandbar component in the primary toolbar\n    globalRegistry.get('containers').set('PrimaryToolbar/Middle/CommandBar', CommandBarUiPlugin);\n\n    // Register reducer\n    globalRegistry.get('reducers').set('Shel.Neos.CommandBar', { reducer });\n\n    // Register hotkeys\n    if (frontendConfiguration.hotkeys !== null && frontendConfiguration.hotkeys.length !== 0) {\n        const hotkeyRegistry = globalRegistry.get('hotkeys');\n        hotkeyRegistry.set('Shel.Neos.CommandBar.toggle.CMD', {\n            description: 'Toggle command bar',\n            action: actions.toggleCommandBar,\n        });\n        hotkeyRegistry.set('Shel.Neos.CommandBar.toggle.CTRL', {\n            description: 'Toggle command bar',\n            action: actions.toggleCommandBar,\n        });\n    }\n});\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nexports.__esModule = true;\nexports.SynchronousMetaRegistry = exports.SynchronousRegistry = exports.readFromConsumerApi = exports.createConsumerApi = void 0;\nvar createConsumerApi_1 = __importDefault(require(\"./createConsumerApi\"));\nexports.createConsumerApi = createConsumerApi_1[\"default\"];\nvar readFromConsumerApi_1 = __importDefault(require(\"./readFromConsumerApi\"));\nexports.readFromConsumerApi = readFromConsumerApi_1[\"default\"];\nvar index_1 = require(\"./registry/index\");\nexports.SynchronousRegistry = index_1.SynchronousRegistry;\nexports.SynchronousMetaRegistry = index_1.SynchronousMetaRegistry;\nexports[\"default\"] = (0, readFromConsumerApi_1[\"default\"])('manifest');\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nexports.__esModule = true;\nvar manifest_1 = __importDefault(require(\"./manifest\"));\nvar createReadOnlyValue = function (value) { return ({\n    value: value,\n    writable: false,\n    enumerable: false,\n    configurable: true\n}); };\nfunction createConsumerApi(manifests, exposureMap) {\n    var api = {};\n    Object.keys(exposureMap).forEach(function (key) {\n        Object.defineProperty(api, key, createReadOnlyValue(exposureMap[key]));\n    });\n    Object.defineProperty(api, '@manifest', createReadOnlyValue((0, manifest_1[\"default\"])(manifests)));\n    Object.defineProperty(window, '@Neos:HostPluginAPI', createReadOnlyValue(api));\n}\nexports[\"default\"] = createConsumerApi;\n//# sourceMappingURL=createConsumerApi.js.map","\"use strict\";\nexports.__esModule = true;\nexports[\"default\"] = (function (manifests) {\n    return function (identifier, options, bootstrap) {\n        var _a;\n        manifests.push((_a = {},\n            _a[identifier] = {\n                options: options,\n                bootstrap: bootstrap\n            },\n            _a));\n    };\n});\n//# sourceMappingURL=manifest.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nexports.__esModule = true;\nexports.SynchronousMetaRegistry = exports.SynchronousRegistry = void 0;\nvar SynchronousRegistry_1 = __importDefault(require(\"./SynchronousRegistry\"));\nexports.SynchronousRegistry = SynchronousRegistry_1[\"default\"];\nvar SynchronousMetaRegistry_1 = __importDefault(require(\"./SynchronousMetaRegistry\"));\nexports.SynchronousMetaRegistry = SynchronousMetaRegistry_1[\"default\"];\n//# sourceMappingURL=index.js.map","\"use strict\";\nexports.__esModule = true;\nvar AbstractRegistry = (function () {\n    function AbstractRegistry(description) {\n        this.SERIAL_VERSION_UID = 'd8a5aa78-978e-11e6-ae22-56b6b6499611';\n        this.description = description;\n    }\n    return AbstractRegistry;\n}());\nexports[\"default\"] = AbstractRegistry;\n//# sourceMappingURL=AbstractRegistry.js.map","\"use strict\";\nexports.__esModule = true;\nvar tslib_1 = require(\"tslib\");\nvar positionalArraySorter = function (subject, position, idKey) {\n    var e_1, _a, e_2, _b, e_3, _c, e_4, _d, e_5, _e, e_6, _f, e_7, _g;\n    if (position === void 0) { position = 'position'; }\n    if (idKey === void 0) { idKey = 'key'; }\n    var positionAccessor = typeof position === 'string' ? function (value) { return value[position]; } : position;\n    var indexMapping = {};\n    var middleKeys = {};\n    var startKeys = {};\n    var endKeys = {};\n    var beforeKeys = {};\n    var afterKeys = {};\n    subject.forEach(function (item, index) {\n        var key = item[idKey] ? item[idKey] : String(index);\n        indexMapping[key] = index;\n        var positionValue = positionAccessor(item);\n        var position = String(positionValue ? positionValue : index);\n        var invalid = false;\n        if (position.startsWith('start')) {\n            var weightMatch = position.match(/start\\s+(\\d+)/);\n            var weight = weightMatch && weightMatch[1] ? Number(weightMatch[1]) : 0;\n            if (!startKeys[weight]) {\n                startKeys[weight] = [];\n            }\n            startKeys[weight].push(key);\n        }\n        else if (position.startsWith('end')) {\n            var weightMatch = position.match(/end\\s+(\\d+)/);\n            var weight = weightMatch && weightMatch[1] ? Number(weightMatch[1]) : 0;\n            if (!endKeys[weight]) {\n                endKeys[weight] = [];\n            }\n            endKeys[weight].push(key);\n        }\n        else if (position.startsWith('before')) {\n            var match = position.match(/before\\s+(\\S+)(\\s+(\\d+))?/);\n            if (!match) {\n                invalid = true;\n            }\n            else {\n                var reference = match[1];\n                var weight = match[3] ? Number(match[3]) : 0;\n                if (!beforeKeys[reference]) {\n                    beforeKeys[reference] = {};\n                }\n                if (!beforeKeys[reference][weight]) {\n                    beforeKeys[reference][weight] = [];\n                }\n                beforeKeys[reference][weight].push(key);\n            }\n        }\n        else if (position.startsWith('after')) {\n            var match = position.match(/after\\s+(\\S+)(\\s+(\\d+))?/);\n            if (!match) {\n                invalid = true;\n            }\n            else {\n                var reference = match[1];\n                var weight = match[3] ? Number(match[3]) : 0;\n                if (!afterKeys[reference]) {\n                    afterKeys[reference] = {};\n                }\n                if (!afterKeys[reference][weight]) {\n                    afterKeys[reference][weight] = [];\n                }\n                afterKeys[reference][weight].push(key);\n            }\n        }\n        else {\n            invalid = true;\n        }\n        if (invalid) {\n            var numberPosition = parseFloat(position);\n            if (isNaN(numberPosition) || !isFinite(numberPosition)) {\n                numberPosition = index;\n            }\n            if (!middleKeys[numberPosition]) {\n                middleKeys[numberPosition] = [];\n            }\n            middleKeys[numberPosition].push(key);\n        }\n    });\n    var resultStart = [];\n    var resultMiddle = [];\n    var resultEnd = [];\n    var processedKeys = [];\n    var sortedWeights = function (dict, asc) {\n        var weights = Object.keys(dict).map(function (x) { return Number(x); }).sort(function (a, b) { return a - b; });\n        return asc ? weights : weights.reverse();\n    };\n    var addToResults = function (keys, result) {\n        keys.forEach(function (key) {\n            var e_8, _a, e_9, _b;\n            if (processedKeys.indexOf(key) >= 0) {\n                return;\n            }\n            processedKeys.push(key);\n            if (beforeKeys[key]) {\n                var beforeWeights = sortedWeights(beforeKeys[key], true);\n                try {\n                    for (var beforeWeights_1 = tslib_1.__values(beforeWeights), beforeWeights_1_1 = beforeWeights_1.next(); !beforeWeights_1_1.done; beforeWeights_1_1 = beforeWeights_1.next()) {\n                        var i = beforeWeights_1_1.value;\n                        addToResults(beforeKeys[key][i], result);\n                    }\n                }\n                catch (e_8_1) { e_8 = { error: e_8_1 }; }\n                finally {\n                    try {\n                        if (beforeWeights_1_1 && !beforeWeights_1_1.done && (_a = beforeWeights_1[\"return\"])) _a.call(beforeWeights_1);\n                    }\n                    finally { if (e_8) throw e_8.error; }\n                }\n            }\n            result.push(key);\n            if (afterKeys[key]) {\n                var afterWeights = sortedWeights(afterKeys[key], false);\n                try {\n                    for (var afterWeights_1 = tslib_1.__values(afterWeights), afterWeights_1_1 = afterWeights_1.next(); !afterWeights_1_1.done; afterWeights_1_1 = afterWeights_1.next()) {\n                        var i = afterWeights_1_1.value;\n                        addToResults(afterKeys[key][i], result);\n                    }\n                }\n                catch (e_9_1) { e_9 = { error: e_9_1 }; }\n                finally {\n                    try {\n                        if (afterWeights_1_1 && !afterWeights_1_1.done && (_b = afterWeights_1[\"return\"])) _b.call(afterWeights_1);\n                    }\n                    finally { if (e_9) throw e_9.error; }\n                }\n            }\n        });\n    };\n    try {\n        for (var _h = tslib_1.__values(sortedWeights(startKeys, false)), _j = _h.next(); !_j.done; _j = _h.next()) {\n            var i = _j.value;\n            addToResults(startKeys[i], resultStart);\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (_j && !_j.done && (_a = _h[\"return\"])) _a.call(_h);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    try {\n        for (var _k = tslib_1.__values(sortedWeights(middleKeys, true)), _l = _k.next(); !_l.done; _l = _k.next()) {\n            var i = _l.value;\n            addToResults(middleKeys[i], resultMiddle);\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (_l && !_l.done && (_b = _k[\"return\"])) _b.call(_k);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    try {\n        for (var _m = tslib_1.__values(sortedWeights(endKeys, true)), _o = _m.next(); !_o.done; _o = _m.next()) {\n            var i = _o.value;\n            addToResults(endKeys[i], resultEnd);\n        }\n    }\n    catch (e_3_1) { e_3 = { error: e_3_1 }; }\n    finally {\n        try {\n            if (_o && !_o.done && (_c = _m[\"return\"])) _c.call(_m);\n        }\n        finally { if (e_3) throw e_3.error; }\n    }\n    try {\n        for (var _p = tslib_1.__values(Object.keys(beforeKeys)), _q = _p.next(); !_q.done; _q = _p.next()) {\n            var key = _q.value;\n            if (processedKeys.indexOf(key) >= 0) {\n                continue;\n            }\n            try {\n                for (var _r = (e_5 = void 0, tslib_1.__values(sortedWeights(beforeKeys[key], false))), _s = _r.next(); !_s.done; _s = _r.next()) {\n                    var i = _s.value;\n                    addToResults(beforeKeys[key][i], resultStart);\n                }\n            }\n            catch (e_5_1) { e_5 = { error: e_5_1 }; }\n            finally {\n                try {\n                    if (_s && !_s.done && (_e = _r[\"return\"])) _e.call(_r);\n                }\n                finally { if (e_5) throw e_5.error; }\n            }\n        }\n    }\n    catch (e_4_1) { e_4 = { error: e_4_1 }; }\n    finally {\n        try {\n            if (_q && !_q.done && (_d = _p[\"return\"])) _d.call(_p);\n        }\n        finally { if (e_4) throw e_4.error; }\n    }\n    try {\n        for (var _t = tslib_1.__values(Object.keys(afterKeys)), _u = _t.next(); !_u.done; _u = _t.next()) {\n            var key = _u.value;\n            if (processedKeys.indexOf(key) >= 0) {\n                continue;\n            }\n            try {\n                for (var _v = (e_7 = void 0, tslib_1.__values(sortedWeights(afterKeys[key], false))), _w = _v.next(); !_w.done; _w = _v.next()) {\n                    var i = _w.value;\n                    addToResults(afterKeys[key][i], resultMiddle);\n                }\n            }\n            catch (e_7_1) { e_7 = { error: e_7_1 }; }\n            finally {\n                try {\n                    if (_w && !_w.done && (_g = _v[\"return\"])) _g.call(_v);\n                }\n                finally { if (e_7) throw e_7.error; }\n            }\n        }\n    }\n    catch (e_6_1) { e_6 = { error: e_6_1 }; }\n    finally {\n        try {\n            if (_u && !_u.done && (_f = _t[\"return\"])) _f.call(_t);\n        }\n        finally { if (e_6) throw e_6.error; }\n    }\n    var sortedKeys = tslib_1.__spread(resultStart, resultMiddle, resultEnd);\n    return sortedKeys.map(function (key) { return indexMapping[key]; }).map(function (i) { return subject[i]; });\n};\nexports[\"default\"] = positionalArraySorter;\n//# sourceMappingURL=positionalArraySorter.js.map","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nexports.__esModule = true;\nvar SynchronousRegistry_1 = __importDefault(require(\"./SynchronousRegistry\"));\nvar SynchronousMetaRegistry = (function (_super) {\n    __extends(SynchronousMetaRegistry, _super);\n    function SynchronousMetaRegistry() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SynchronousMetaRegistry.prototype.set = function (key, value) {\n        if (value.SERIAL_VERSION_UID !== 'd8a5aa78-978e-11e6-ae22-56b6b6499611') {\n            throw new Error('You can only add registries to a meta registry');\n        }\n        return _super.prototype.set.call(this, key, value);\n    };\n    return SynchronousMetaRegistry;\n}(SynchronousRegistry_1[\"default\"]));\nexports[\"default\"] = SynchronousMetaRegistry;\n//# sourceMappingURL=SynchronousMetaRegistry.js.map","import FuzzySearch from 'fuzzy-search';\nvar ACTIONS;\n(function (ACTIONS) {\n    ACTIONS[ACTIONS[\"RESET_SEARCH\"] = 0] = \"RESET_SEARCH\";\n    ACTIONS[ACTIONS[\"HIGHLIGHT_NEXT_ITEM\"] = 1] = \"HIGHLIGHT_NEXT_ITEM\";\n    ACTIONS[ACTIONS[\"HIGHLIGHT_PREVIOUS_ITEM\"] = 2] = \"HIGHLIGHT_PREVIOUS_ITEM\";\n    ACTIONS[ACTIONS[\"CANCEL\"] = 3] = \"CANCEL\";\n    ACTIONS[ACTIONS[\"SELECT_GROUP\"] = 4] = \"SELECT_GROUP\";\n    ACTIONS[ACTIONS[\"GO_TO_PARENT_GROUP\"] = 5] = \"GO_TO_PARENT_GROUP\";\n    ACTIONS[ACTIONS[\"UPDATE_SEARCH\"] = 6] = \"UPDATE_SEARCH\";\n    ACTIONS[ACTIONS[\"RUNNING_COMMAND\"] = 7] = \"RUNNING_COMMAND\";\n    ACTIONS[ACTIONS[\"FINISHED_COMMAND\"] = 8] = \"FINISHED_COMMAND\";\n    ACTIONS[ACTIONS[\"SET_RESULT\"] = 9] = \"SET_RESULT\";\n})(ACTIONS || (ACTIONS = {}));\nfunction clamp(value, min, max) {\n    return Math.max(min, Math.min(max, value));\n}\nfunction filterAvailableCommands(selectedCommandGroup, searchWord, commands) {\n    // Filter available commands for the current context\n    const availableCommands = Object.values(commands).filter((command) => command.parentId === selectedCommandGroup);\n    if (!searchWord) {\n        return availableCommands.map((command) => command.id);\n    }\n    const searcher = new FuzzySearch(availableCommands, ['name'], {\n        sort: true,\n    });\n    const matchingCommands = searcher.search(searchWord);\n    // Add all commands that can handle queries to the result\n    return [\n        ...new Set([\n            ...matchingCommands.map((command) => command.id),\n            ...availableCommands.filter((command) => command.canHandleQueries).map((command) => command.id),\n        ]),\n    ];\n}\nconst commandBarReducer = (state, action) => {\n    // The parent command group of the currently selected command group which is used in several actions\n    const parentCommandGroup = state.selectedCommandGroup ? state.commands[state.selectedCommandGroup].parentId : null;\n    switch (action.type) {\n        case ACTIONS.RESET_SEARCH:\n            return {\n                ...state,\n                searchWord: '',\n                highlightedItem: 0,\n                availableCommandIds: filterAvailableCommands(state.selectedCommandGroup, '', state.commands),\n                result: null,\n            };\n        case ACTIONS.HIGHLIGHT_NEXT_ITEM:\n            return {\n                ...state,\n                expanded: true,\n                highlightedItem: state.expanded\n                    ? clamp(state.highlightedItem + 1, 0, state.availableCommandIds.length - 1)\n                    : 0,\n            };\n        case ACTIONS.HIGHLIGHT_PREVIOUS_ITEM:\n            return {\n                ...state,\n                highlightedItem: clamp(state.highlightedItem - 1, 0, state.availableCommandIds.length - 1),\n            };\n        case ACTIONS.CANCEL:\n            // Either leave the result view, cancel current search,  or traverse to parent group\n            return state.result\n                ? {\n                    ...state,\n                    result: null,\n                }\n                : state.searchWord\n                    ? {\n                        ...state,\n                        searchWord: '',\n                        highlightedItem: 0,\n                        availableCommandIds: filterAvailableCommands(state.selectedCommandGroup, '', state.commands),\n                    }\n                    : {\n                        ...state,\n                        selectedCommandGroup: parentCommandGroup,\n                        availableCommandIds: filterAvailableCommands(parentCommandGroup, '', state.commands),\n                    };\n        case ACTIONS.GO_TO_PARENT_GROUP:\n            return {\n                ...state,\n                highlightedItem: 0,\n                selectedCommandGroup: null,\n                availableCommandIds: filterAvailableCommands(parentCommandGroup, '', state.commands),\n                result: null,\n            };\n        case ACTIONS.SELECT_GROUP:\n            return {\n                ...state,\n                searchWord: '',\n                highlightedItem: 0,\n                selectedCommandGroup: action.commandId,\n                availableCommandIds: filterAvailableCommands(action.commandId, '', state.commands),\n                result: null,\n            };\n        case ACTIONS.UPDATE_SEARCH: {\n            return {\n                ...state,\n                expanded: true,\n                searchWord: action.argument,\n                highlightedItem: 0,\n                availableCommandIds: filterAvailableCommands(state.selectedCommandGroup, action.argument, state.commands),\n            };\n        }\n        case ACTIONS.RUNNING_COMMAND: {\n            return {\n                ...state,\n                runningCommandId: action.commandId,\n                runningCommandMessage: action.argument,\n            };\n        }\n        case ACTIONS.FINISHED_COMMAND: {\n            return {\n                ...state,\n                runningCommandId: null,\n                runningCommandMessage: null,\n            };\n        }\n        case ACTIONS.SET_RESULT: {\n            return {\n                ...state,\n                result: {\n                    ...action.result,\n                },\n            };\n        }\n        default:\n            throw new Error(`Invalid action ${action.type}`);\n    }\n};\nexport { commandBarReducer, ACTIONS };\n","export default class Helper {\n  static getDescendantProperty(object, path, list = []) {\n    let firstSegment;\n    let remaining;\n    let dotIndex;\n    let value;\n    let index;\n    let length;\n\n    if (path) {\n      dotIndex = path.indexOf('.');\n\n      if (dotIndex === -1) {\n        firstSegment = path;\n      } else {\n        firstSegment = path.slice(0, dotIndex);\n        remaining = path.slice(dotIndex + 1);\n      }\n\n      value = object[firstSegment];\n      if (value !== null && typeof value !== 'undefined') {\n        if (! remaining && (typeof value === 'string' || typeof value === 'number')) {\n          list.push(value);\n        } else if (Object.prototype.toString.call(value) === '[object Array]') {\n          for (index = 0, length = value.length; index < length; index++) {\n            Helper.getDescendantProperty(value[index], remaining, list);\n          }\n        } else if (remaining) {\n          Helper.getDescendantProperty(value, remaining, list);\n        }\n      }\n    } else {\n      list.push(object);\n    }\n\n    return list;\n  }\n}\n","import Helper from './Helper';\n\nexport default class FuzzySearch {\n  constructor(haystack = [], keys = [], options = {}) {\n    if (! Array.isArray(keys)) {\n      options = keys;\n      keys = [];\n    }\n\n    this.haystack = haystack;\n    this.keys = keys;\n    this.options = Object.assign({\n      caseSensitive: false,\n      sort: false,\n    }, options);\n  }\n\n  search(query = '') {\n    if (query === '') {\n      return this.haystack;\n    }\n\n    const results = [];\n\n    for (let i = 0; i < this.haystack.length; i++) {\n      const item = this.haystack[i];\n\n      if (this.keys.length === 0) {\n        const score = FuzzySearch.isMatch(item, query, this.options.caseSensitive);\n\n        if (score) {\n          results.push({ item, score });\n        }\n      } else {\n        for (let y = 0; y < this.keys.length; y++) {\n          const propertyValues = Helper.getDescendantProperty(item, this.keys[y]);\n\n          let found = false;\n\n          for (let z = 0; z < propertyValues.length; z++) {\n            const score = FuzzySearch.isMatch(propertyValues[z], query, this.options.caseSensitive);\n\n            if (score) {\n              found = true;\n\n              results.push({ item, score });\n\n              break;\n            }\n          }\n\n          if (found) {\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.options.sort) {\n      results.sort((a, b) => a.score - b.score);\n    }\n\n    return results.map(result => result.item);\n  }\n\n  static isMatch(item, query, caseSensitive) {\n    item = String(item);\n    query = String(query);\n\n    if (! caseSensitive) {\n      item = item.toLocaleLowerCase();\n      query = query.toLocaleLowerCase();\n    }\n\n    const indexes = FuzzySearch.nearestIndexesFor(item, query);\n\n    if (! indexes) {\n      return false;\n    }\n\n    // Exact matches should be first.\n    if (item === query) {\n      return 1;\n    }\n\n    // If we have more than 2 letters, matches close to each other should be first.\n    if (indexes.length > 1) {\n      return 2 + (indexes[indexes.length - 1] - indexes[0]);\n    }\n\n    // Matches closest to the start of the string should be first.\n    return 2 + indexes[0];\n  }\n\n  static nearestIndexesFor(item, query) {\n    const letters = query.split('');\n    let indexes = [];\n\n    const indexesOfFirstLetter = FuzzySearch.indexesOfFirstLetter(item, query);\n\n    indexesOfFirstLetter.forEach((startingIndex, loopingIndex) => {\n      let index = startingIndex + 1;\n\n      indexes[loopingIndex] = [startingIndex];\n\n      for (let i = 1; i < letters.length; i++) {\n        const letter = letters[i];\n\n        index = item.indexOf(letter, index);\n\n        if (index === -1) {\n          indexes[loopingIndex] = false;\n\n          break;\n        }\n\n        indexes[loopingIndex].push(index);\n\n        index++;\n      }\n    });\n\n    indexes = indexes.filter(letterIndexes => letterIndexes !== false);\n\n    if (! indexes.length) {\n      return false;\n    }\n\n    return indexes.sort((a, b) => {\n      if (a.length === 1) {\n        return a[0] - b[0];\n      }\n\n      a = a[a.length - 1] - a[0];\n      b = b[b.length - 1] - b[0];\n\n      return a - b;\n    })[0];\n  }\n\n  static indexesOfFirstLetter(item, query) {\n    const match = query[0];\n\n    return item.split('').map((letter, index) => {\n      if (letter !== match) {\n        return false;\n      }\n\n      return index;\n    }).filter(index => index !== false);\n  }\n}\n","import * as React from 'react';\nimport { Icon as NeosIcon } from '@neos-project/react-ui-components';\nimport * as styles from './Icon.module.css';\nconst Icon = ({ icon, spin = false }) => {\n    return (React.createElement(\"span\", { className: styles.iconWrap },\n        React.createElement(NeosIcon, { icon: icon, spin: spin })));\n};\nexport default React.memo(Icon);\n","import * as React from 'react';\nimport Icon from '../Presentationals/Icon';\nimport * as styles from './CommandBarFooter.module.css';\nconst CommandBarFooter = ({ selectedGroup, runningCommand, runningCommandMessage }) => {\n    return (React.createElement(\"footer\", { className: styles.commandBarFooter },\n        runningCommand ? (React.createElement(\"span\", { className: styles.activity },\n            React.createElement(Icon, { icon: \"circle-notch\", spin: true }),\n            React.createElement(\"em\", null,\n                runningCommand.name,\n                \" \\u2012 \",\n                runningCommandMessage))) : selectedGroup ? (React.createElement(\"span\", { className: styles.breadcrumb },\n            React.createElement(Icon, { icon: selectedGroup.icon }),\n            React.createElement(\"small\", null, selectedGroup.name))) : (React.createElement(Icon, { icon: \"neos\" })),\n        React.createElement(\"a\", { href: \"https://helzle.it\", title: \"Made with love by Sebastian Helzle\", target: \"_blank\", rel: \"noreferrer noopener\", className: styles.madeWithLove },\n            React.createElement(\"small\", null, \"Made with love by\"),\n            React.createElement(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", width: \"18\", height: \"18\", viewBox: \"0 0 180 180\" },\n                React.createElement(\"defs\", null,\n                    React.createElement(\"linearGradient\", { id: \"a\", gradientUnits: \"userSpaceOnUse\", x1: \"280.25\", y1: \"377.003\", x2: \"373.261\", y2: \"377.003\" },\n                        React.createElement(\"stop\", { offset: \"0\", stopColor: \"#297AAC\" }),\n                        React.createElement(\"stop\", { offset: \"1\", stopColor: \"#53AADA\" }))),\n                React.createElement(\"path\", { d: \"M0 180.017h37.287L71.35 52.898H34.061zM48.717 0l-9.083 33.898h36.675L85.392 0z\", fill: \"#B9B7B3\" }),\n                React.createElement(\"path\", { d: \"M335.972 313.444H288.25l-8 28.306h47.691l-28.03 98.813h39.287l34.063-127.119z\", fill: \"url(#a)\", transform: \"translate(-195.462 -260.325)\" })))));\n};\nexport default CommandBarFooter;\n","import * as React from 'react';\nimport * as styles from './SearchBox.module.css';\nimport { useCallback, useRef } from 'react';\nconst SearchBox = ({ searchWord, onChange }) => {\n    const inputRef = useRef();\n    const handleKeyPress = useCallback((e) => {\n        // Prevent escape event from bubbling up if the input is focused and the native reset should be used\n        if (e.key === 'Escape') {\n            if (inputRef.current.value) {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n        }\n    }, [inputRef.current]);\n    return (React.createElement(\"input\", { ref: inputRef, className: styles.searchBox, type: \"search\", placeholder: \"Search for commands\\u2026\", autoFocus: true, onChange: onChange, onKeyUp: handleKeyPress, value: searchWord }));\n};\nexport default SearchBox;\n","import React from 'react';\nimport { ACTIONS } from '../state/commandBarReducer';\nimport Icon from '../Presentationals/Icon';\nimport SearchBox from '../SearchBox/SearchBox';\nimport * as styles from './CommandBarHeader.module.css';\nconst CommandBarHeader = ({ selectedCommandGroup, searchWord, dispatch, handleSearch, }) => {\n    return (React.createElement(\"header\", { className: styles.commandBarHeader },\n        selectedCommandGroup && (React.createElement(\"button\", { type: \"button\", onClick: () => dispatch({ type: ACTIONS.GO_TO_PARENT_GROUP }), className: styles.backButton },\n            React.createElement(Icon, { icon: \"arrow-left\" }))),\n        React.createElement(SearchBox, { searchWord: searchWord, onChange: handleSearch })));\n};\nexport default CommandBarHeader;\n","import React from 'react';\nimport * as styles from './CommandListItem.module.css';\nimport Icon from '../Presentationals/Icon';\nconst CommandListItem = React.forwardRef(({ command, onItemSelect, highlighted, runningCommandId }, ref) => {\n    const { id, name, description, icon } = command;\n    return (React.createElement(\"li\", { className: [styles.commandListItem, highlighted && styles.highlighted].join(' '), onClick: () => onItemSelect(id), ref: ref },\n        React.createElement(Icon, { icon: icon }),\n        React.createElement(\"span\", { className: styles.label },\n            React.createElement(\"span\", null, name),\n            description && React.createElement(\"small\", null, typeof description == 'string' ? description : description()))));\n});\nCommandListItem.displayName = 'CommandListItem';\n// Update component when the command, highlight or last executed command changes to allow a refresh of the commands properties\nexport default React.memo(CommandListItem, (prev, next) => {\n    return (prev.command.id === next.command.id && prev.ref === next.ref && prev.runningCommandId === next.runningCommandId);\n});\n","import React, { useEffect } from 'react';\nimport * as styles from './CommandListing.module.css';\nimport CommandListItem from './CommandListItem';\nconst CommandListing = ({ commands, availableCommandIds, highlightedItem, handleSelectItem, heading = 'Commands', runningCommandId = '', noCommandsMessage = 'No matching commands found', }) => {\n    const selectedElementRef = React.useRef(null);\n    useEffect(() => {\n        var _a;\n        (_a = selectedElementRef.current) === null || _a === void 0 ? void 0 : _a.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n    }, [selectedElementRef.current]);\n    return (React.createElement(\"nav\", { className: styles.results },\n        heading && React.createElement(\"h6\", null, heading),\n        availableCommandIds.length > 0 ? (React.createElement(\"ul\", null, availableCommandIds.map((commandId, index) => (React.createElement(CommandListItem, { key: commandId, ref: highlightedItem === index ? selectedElementRef : null, command: commands[commandId], onItemSelect: handleSelectItem, highlighted: highlightedItem === index, runningCommandId: runningCommandId }))))) : (React.createElement(\"small\", { className: styles.noResults }, noCommandsMessage))));\n};\nexport default React.memo(CommandListing);\n","/**\n * This method converts the hierarchical command list into a flat list of commands which is more convenient\n * for internal processing, whereas the hierarchical command list is more convenient for the user.\n */\nexport function flattenCommands(commands, parentId = null) {\n    return Object.keys(commands).reduce((commandList, commandId) => {\n        const { icon, description, name, subCommands, action, canHandleQueries } = commands[commandId];\n        // Create an uniquely identifiable command id for the flat command list\n        const absoluteCommandId = parentId ? `${parentId}.${commandId}` : commandId;\n        // Create list of available subcommand names\n        const subCommandIds = subCommands\n            ? Object.keys(subCommands).map((subCommandId) => `${absoluteCommandId}.${subCommandId}`)\n            : [];\n        // Insert the processed command into the flat command list\n        commandList[absoluteCommandId] = {\n            id: absoluteCommandId,\n            name,\n            icon,\n            description,\n            action,\n            canHandleQueries,\n            subCommandIds,\n            parentId,\n        };\n        // Insert subcommands into the list\n        if (subCommandIds.length > 0) {\n            return {\n                ...commandList,\n                ...flattenCommands(subCommands, absoluteCommandId),\n            };\n        }\n        return commandList;\n    }, {});\n}\n","import React, { useCallback } from 'react';\nimport * as styles from './CommandResultsView.module.css';\nimport CommandListing from '../CommandList/CommandListing';\nconst CommandResultsView = ({ result }) => {\n    const { options, view, message } = result;\n    const handleSelectItem = useCallback((commandId) => {\n        const { action } = options[commandId];\n        if (!action)\n            return;\n        if (typeof action == 'string') {\n            window.location.href = action;\n            return;\n        }\n        console.debug('Running action result command', commandId);\n        action();\n    }, [options]);\n    return (React.createElement(\"div\", { className: styles.commandResultsView },\n        view ? React.createElement(\"div\", null, view) : '',\n        options && (React.createElement(CommandListing, { heading: message, commands: options, availableCommandIds: Object.keys(options), highlightedItem: 0, handleSelectItem: handleSelectItem, noCommandsMessage: \"Try a different query to find more results\" }))));\n};\nexport default React.memo(CommandResultsView);\n","import React, { useCallback, useEffect, useReducer, useRef } from 'react';\nimport * as styles from './CommandBar.module.css';\nimport { ACTIONS, commandBarReducer } from './state/commandBarReducer';\nimport CommandBarFooter from './CommandBarFooter/CommandBarFooter';\nimport CommandBarHeader from './CommandBarHeader/CommandBarHeader';\nimport CommandListing from './CommandList/CommandListing';\nimport { flattenCommands } from './helpers/flattenCommands';\nimport CommandResultsView from './CommandResultsView/CommandResultsView';\nconst initialState = {\n    expanded: false,\n    selectedCommandGroup: null,\n    availableCommandIds: [],\n    searchWord: '',\n    highlightedItem: 0,\n    commands: {},\n    runningCommandId: null,\n    runningCommandMessage: null,\n    result: null,\n};\n/**\n * A custom hook that creates a ref for a function, and updates it on every render.\n * The new value is always the same function, but the function's context changes on every render.\n * TODO: Move to own file\n */\nfunction useRefEventListener(fn) {\n    const fnRef = useRef(fn);\n    fnRef.current = fn;\n    return fnRef;\n}\nconst CommandBar = ({ commands, open, toggleOpen }) => {\n    const [state, dispatch] = useReducer(commandBarReducer, {\n        ...initialState,\n        commands: flattenCommands(commands),\n        availableCommandIds: Object.keys(commands),\n    });\n    const handleKeyEnteredRef = useRefEventListener((e) => {\n        if (!open || e.defaultPrevented) {\n            return;\n        }\n        if (e.key === 'Escape') {\n            e.stopPropagation();\n            e.preventDefault();\n            if (state.selectedCommandGroup || state.searchWord) {\n                dispatch({ type: ACTIONS.CANCEL });\n            }\n            else {\n                // Close command bar if cancel is noop\n                toggleOpen();\n            }\n        }\n        else if (e.key === 'ArrowDown') {\n            e.stopPropagation();\n            e.preventDefault();\n            dispatch({ type: ACTIONS.HIGHLIGHT_NEXT_ITEM });\n        }\n        else if (e.key === 'ArrowUp') {\n            e.stopPropagation();\n            e.preventDefault();\n            dispatch({ type: ACTIONS.HIGHLIGHT_PREVIOUS_ITEM });\n        }\n        else if (e.key === 'Enter' && state.availableCommandIds.length > state.highlightedItem) {\n            e.stopPropagation();\n            e.preventDefault();\n            const commandId = state.availableCommandIds[state.highlightedItem];\n            handleSelectItem(commandId);\n        }\n    });\n    const handleSearch = useCallback((e) => {\n        dispatch({ type: ACTIONS.UPDATE_SEARCH, argument: e.target.value.toLowerCase() });\n    }, []);\n    const handleSelectItem = useCallback(async (commandId) => {\n        const { action, canHandleQueries } = state.commands[commandId];\n        if (!action) {\n            return dispatch({ type: ACTIONS.SELECT_GROUP, commandId });\n        }\n        // FIXME: Show loading indicator and block further actions while command is running or url is opened\n        if (typeof action == 'string') {\n            dispatch({ type: ACTIONS.RUNNING_COMMAND, commandId, argument: 'Loading url' });\n            window.location.href = action;\n            return;\n        }\n        dispatch({ type: ACTIONS.RUNNING_COMMAND, commandId, argument: 'Running command' });\n        const actionResult = action(canHandleQueries ? state.searchWord : undefined);\n        if (actionResult.then) {\n            // Handle Promises\n            actionResult\n                .then((result) => {\n                // TODO: Handle success === false\n                console.debug('Command result', result);\n            })\n                .catch((error) => {\n                // TODO: Show error message\n                console.error('Command error', error);\n            })\n                .finally(() => {\n                dispatch({ type: ACTIONS.FINISHED_COMMAND });\n            });\n        }\n        else if (actionResult.next) {\n            // Handle generators\n            const generator = actionResult;\n            // TODO: Handle errors / success === false\n            for await (const result of generator) {\n                dispatch({ type: ACTIONS.RUNNING_COMMAND, commandId, argument: result.message });\n                if (result.options) {\n                    dispatch({ type: ACTIONS.SET_RESULT, result });\n                }\n            }\n            dispatch({ type: ACTIONS.FINISHED_COMMAND });\n        }\n        else {\n            console.warn('Command result is not a promise or generator', actionResult);\n        }\n    }, [state.searchWord, state.commands]);\n    const handleSelectItemRef = useRefEventListener((commandId) => {\n        const { searchWord } = state;\n        console.debug('searchWord', searchWord);\n        debugger;\n        handleSelectItem(commandId);\n    });\n    /**\n     * Add key event handler, needs to be updated when any parameter for the key event handler changes\n     */\n    useEffect(() => {\n        if (!open)\n            return;\n        // const guestFrame = document.getElementsByName('neos-content-main')[0] as HTMLIFrameElement;\n        // guestFrame.contentWindow?.addEventListener('keyup', (e) => {\n        //     console.debug('keypress in guestframe', e);\n        // });\n        // console.debug('guestFrame', guestFrame.contentWindow);\n        const windowKeyEventHandler = (e) => handleKeyEnteredRef.current(e);\n        window.addEventListener('keydown', windowKeyEventHandler);\n        return () => window.removeEventListener('keydown', windowKeyEventHandler);\n    }, [open]);\n    if (!open) {\n        return null;\n    }\n    return (React.createElement(\"dialog\", { className: [styles.commandBar, state.result && styles.hasResults].join(' '), open: open },\n        React.createElement(CommandBarHeader, { selectedCommandGroup: state.selectedCommandGroup, searchWord: state.searchWord, dispatch: dispatch, handleSearch: handleSearch }),\n        React.createElement(\"div\", { className: [styles.resultsWrap, state.expanded && styles.expanded, state.result && styles.split].join(' ') },\n            React.createElement(CommandListing, { commands: state.commands, availableCommandIds: state.availableCommandIds, highlightedItem: state.highlightedItem, handleSelectItem: (commandId) => handleSelectItemRef.current(commandId), runningCommandId: state.runningCommandId }),\n            state.result && React.createElement(CommandResultsView, { result: state.result })),\n        state.expanded && (React.createElement(CommandBarFooter, { selectedGroup: state.selectedCommandGroup ? state.commands[state.selectedCommandGroup] : null, runningCommand: state.runningCommandId ? state.commands[state.runningCommandId] : null, runningCommandMessage: state.runningCommandMessage }))));\n};\nexport default CommandBar;\n","// @ts-ignore\nimport { fetchWithErrorHandling } from '@neos-project/neos-ui-backend-connector';\nconst fetchData = async (endpoint, params) => {\n    if (params) {\n        endpoint = Object.keys(params).reduce((url, key) => {\n            return url + '&' + key + '=' + encodeURIComponent(params[key]);\n        }, endpoint + '?');\n    }\n    return fetchWithErrorHandling\n        .withCsrfToken((csrfToken) => ({\n        url: endpoint,\n        method: 'GET',\n        credentials: 'include',\n        headers: {\n            'X-Flow-Csrftoken': csrfToken,\n        },\n    }))\n        .then((response) => response && response.json());\n};\nexport default fetchData;\n","import * as React from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport { IconButton } from '@neos-project/react-ui-components';\n// Neos dependencies are provided by the UI\n// @ts-ignore\nimport { neos } from '@neos-project/neos-ui-decorators';\n// @ts-ignore\nimport { selectors, actions } from '@neos-project/neos-ui-redux-store';\nimport CommandBar from '@neos-commandbar/commandbar';\nimport { actions as commandBarActions, selectors as commandBarSelectors } from './actions';\nimport * as styles from './CommandBarUiPlugin.module.css';\nimport fetchData from './helpers/fetchData';\nconst ENDPOINT_COMMANDS = 'service/data-source/shel-neos-commandbar-commands';\nconst ENDPOINT_SEARCH_NODES = 'service/data-source/shel-neos-commandbar-search-nodes';\nclass CommandBarUiPlugin extends React.PureComponent {\n    constructor(props) {\n        super(props);\n        this.buildCommandsFromHotkeys = () => {\n            const { hotkeyRegistry, handleHotkeyAction, config } = this.props;\n            const hotkeys = hotkeyRegistry.getAllAsList();\n            return hotkeys.reduce((carry, { id, description, action }) => {\n                if (!config.hotkeys.filter.includes(id)) {\n                    carry[id] = {\n                        name: description,\n                        description: id,\n                        icon: this.mapHotkeyIdToIcon(id),\n                        action: async () => handleHotkeyAction(action()),\n                    };\n                }\n                return carry;\n            }, {});\n        };\n        this.buildCommandsFromEditPreviewModes = () => {\n            const { setEditPreviewMode, editPreviewModes, i18nRegistry } = this.props;\n            return Object.keys(editPreviewModes).reduce((carry, mode) => {\n                const { title, isEditingMode } = editPreviewModes[mode];\n                carry[mode] = {\n                    name: i18nRegistry.translate(title),\n                    description: () => (this.props.editPreviewMode === mode ? 'Currently active' : ''),\n                    icon: isEditingMode ? 'pencil' : 'eye',\n                    action: async () => setEditPreviewMode(mode),\n                };\n                return carry;\n            }, {});\n        };\n        this.handleAddNode = async () => {\n            const { addNode, documentNode, focusedNodeContextPath, toggleCommandBar } = this.props;\n            toggleCommandBar();\n            addNode(focusedNodeContextPath || documentNode.contextPath, undefined, 'after');\n        };\n        this.handleSearchNode = async function* (query) {\n            const { siteNode, setActiveContentCanvasContextPath, setActiveContentCanvasSrc } = this\n                .props;\n            yield {\n                success: true,\n                message: `Searching for \"${query}\"`,\n            };\n            const results = (await fetchData(ENDPOINT_SEARCH_NODES, { query, node: siteNode.contextPath }).then((results) => {\n                // TODO: Check results\n                console.debug('Search result', results);\n                return results;\n            }));\n            yield {\n                success: true,\n                message: `${results.length} options match your query`,\n                options: results.reduce((carry, { name, nodetype, icon, contextPath, uri }) => {\n                    if (!uri) {\n                        // TODO: Show hint that document cannot be opened?\n                        return carry;\n                    }\n                    carry[contextPath] = {\n                        id: contextPath,\n                        name,\n                        description: nodetype,\n                        action: async () => {\n                            console.debug('Search result selected', contextPath, uri);\n                            setActiveContentCanvasSrc(uri);\n                            setActiveContentCanvasContextPath(contextPath);\n                        },\n                        icon,\n                    };\n                    return carry;\n                }, {}),\n            };\n            // TODO: Show selectable results\n            return {\n                success: true,\n                message: 'Finished searching',\n            };\n        };\n        this.handlePublish = async () => {\n            const { publishableNodesInDocument, publishAction, baseWorkspace } = this.props;\n            publishAction(publishableNodesInDocument.map((node) => node.contextPath), baseWorkspace);\n            return {\n                success: true,\n                message: `Published ${publishableNodesInDocument.length} changes`,\n            };\n        };\n        this.handlePublishAll = async () => {\n            const { publishableNodes, publishAction, baseWorkspace } = this.props;\n            publishAction(publishableNodes.map((node) => node.contextPath), baseWorkspace);\n            return {\n                success: true,\n                message: `Published ${publishableNodes.length} changes`,\n            };\n        };\n        this.handleDiscard = async () => {\n            const { publishableNodesInDocument, discardAction } = this.props;\n            discardAction(publishableNodesInDocument.map((node) => node.contextPath));\n            return {\n                success: true,\n                message: `Discarded ${publishableNodesInDocument.length} changes`,\n            };\n        };\n        this.handleDiscardAll = async () => {\n            const { publishableNodes, discardAction } = this.props;\n            discardAction(publishableNodes.map((node) => node.contextPath));\n            return {\n                success: true,\n                message: `Discarded ${publishableNodes.length} changes`,\n            };\n        };\n        this.state = {\n            loaded: false,\n            commands: {\n                // testGenerator: {\n                //     name: 'Test generator',\n                //     icon: 'vial',\n                //     description: 'Wait and return iterate on command results',\n                //     action: async function* () {\n                //         yield {\n                //             success: true,\n                //             message: 'Doing some testing step 1',\n                //         };\n                //         await new Promise((resolve) => setTimeout(resolve, 2000));\n                //         yield {\n                //             success: true,\n                //             message: 'Doing some more testing step 2',\n                //         };\n                //         await new Promise((resolve) => setTimeout(resolve, 2000));\n                //         return {\n                //             success: true,\n                //             message: 'Finished testing',\n                //         };\n                //     },\n                // },\n                addNode: {\n                    name: 'Add node',\n                    icon: 'plus',\n                    description: 'Add a new node',\n                    action: this.handleAddNode,\n                },\n                searchDocuments: {\n                    name: 'Search documents',\n                    icon: 'search',\n                    description: 'Search and navigate to documents',\n                    action: this.handleSearchNode.bind(this),\n                    canHandleQueries: true,\n                },\n                publishDiscard: {\n                    name: 'Publish or discard changes',\n                    description: 'Publish or discard changes',\n                    icon: 'check',\n                    subCommands: {\n                        publish: {\n                            name: 'Publish',\n                            description: 'Publish changes on this document',\n                            icon: 'check',\n                            action: this.handlePublish,\n                        },\n                        publishAll: {\n                            name: 'Publish all',\n                            description: 'Publish all changes',\n                            icon: 'check-double',\n                            action: this.handlePublishAll,\n                        },\n                        discard: {\n                            name: 'Discard',\n                            description: 'Discard changes on this document',\n                            icon: 'ban',\n                            action: this.handleDiscard,\n                        },\n                        discardAll: {\n                            name: 'Discard all',\n                            description: 'Discard all changes',\n                            icon: 'ban',\n                            action: this.handleDiscardAll,\n                        },\n                    },\n                },\n                quickActions: {\n                    name: 'Quick actions',\n                    icon: 'keyboard',\n                    description: 'Execute configured hotkeys',\n                    subCommands: this.buildCommandsFromHotkeys(),\n                },\n                switchEditPreviewMode: {\n                    name: 'Switch edit/preview mode',\n                    icon: 'pencil',\n                    description: 'Switch between edit and preview modes',\n                    subCommands: this.buildCommandsFromEditPreviewModes(),\n                },\n            },\n        };\n    }\n    mapHotkeyIdToIcon(id) {\n        let actionName = id.split('.').pop();\n        // Some actions have the name 'toggle' with a suffix, e.g. 'toggleFullScreen'\n        if (actionName.indexOf('toggle') >= 0) {\n            actionName = 'toggle';\n        }\n        switch (actionName) {\n            case 'toggle':\n                return 'toggle-on';\n            case 'reload':\n                return 'redo';\n            case 'cancel':\n            case 'close':\n                return 'window-close';\n            case 'apply':\n                return 'check';\n        }\n        return 'neos';\n    }\n    componentDidMount() {\n        const { plugins } = this.props;\n        // Load 3rd party commands\n        if (plugins) {\n            Object.keys(plugins).forEach((pluginName) => {\n                try {\n                    const pluginCommands = plugins[pluginName]();\n                    this.setState((prev) => ({ commands: { ...prev.commands, ...pluginCommands } }));\n                }\n                catch (e) {\n                    console.error(`[CommandBar] Could not load commands from plugin ${pluginName}`, e);\n                }\n            });\n        }\n        // Load commands from data source which are not available via the UI API\n        fetchData(ENDPOINT_COMMANDS)\n            .then((commands) => {\n            this.setState((prev) => ({ loaded: true, commands: { ...prev.commands, ...commands } }));\n        })\n            .catch((error) => {\n            console.error('[CommandBar] Failed to load commands', error);\n        });\n    }\n    render() {\n        const { commandBarOpen, toggleCommandBar } = this.props;\n        const { commands, loaded } = this.state;\n        return (React.createElement(\"div\", null,\n            React.createElement(IconButton, { onClick: () => toggleCommandBar(), isActive: commandBarOpen, title: \"Toggle command bar\", icon: \"search\", disabled: !loaded }),\n            loaded && (React.createElement(\"div\", { className: [styles.fullScreenLayer, commandBarOpen && styles.open].join(' ') },\n                React.createElement(CommandBar, { open: commandBarOpen, commands: commands, toggleOpen: toggleCommandBar })))));\n    }\n}\nCommandBarUiPlugin.propTypes = {\n    config: PropTypes.object.isRequired,\n    i18nRegistry: PropTypes.object.isRequired,\n    siteNode: PropTypes.object,\n    documentNode: PropTypes.object,\n    focusedNodeContextPath: PropTypes.string,\n    commandBarOpen: PropTypes.bool,\n    toggleCommandBar: PropTypes.func.isRequired,\n    handleHotkeyAction: PropTypes.func.isRequired,\n    hotkeyRegistry: PropTypes.object.isRequired,\n    addNode: PropTypes.func.isRequired,\n    editPreviewMode: PropTypes.string.isRequired,\n    setEditPreviewMode: PropTypes.func.isRequired,\n    editPreviewModes: PropTypes.object.isRequired,\n    publishableNodes: PropTypes.array,\n    publishableNodesInDocument: PropTypes.array,\n    isWorkspaceReadOnly: PropTypes.bool,\n    publishAction: PropTypes.func.isRequired,\n    discardAction: PropTypes.func.isRequired,\n    baseWorkspace: PropTypes.string.isRequired,\n    setActiveContentCanvasContextPath: PropTypes.func.isRequired,\n    setActiveContentCanvasSrc: PropTypes.func.isRequired,\n};\nconst mapStateToProps = (state) => ({\n    siteNode: selectors.CR.Nodes.siteNodeSelector(state),\n    documentNode: selectors.CR.Nodes.documentNodeSelector(state),\n    focusedNodeContextPath: selectors.CR.Nodes.focusedNodePathSelector(state),\n    publishableNodes: selectors.CR.Workspaces.publishableNodesSelector(state),\n    publishableNodesInDocument: selectors.CR.Workspaces.publishableNodesInDocumentSelector(state),\n    isWorkspaceReadOnly: selectors.CR.Workspaces.isWorkspaceReadOnlySelector(state),\n    baseWorkspace: selectors.CR.Workspaces.baseWorkspaceSelector(state),\n    commandBarOpen: commandBarSelectors.commandBarOpen(state),\n    editPreviewMode: selectors.UI.EditPreviewMode.currentEditPreviewMode(state),\n});\nconst mapDispatchToProps = (dispatch) => ({\n    handleHotkeyAction: dispatch,\n});\nconst mapGlobalRegistryToProps = neos((globalRegistry) => ({\n    i18nRegistry: globalRegistry.get('i18n'),\n    hotkeyRegistry: globalRegistry.get('hotkeys'),\n    config: globalRegistry.get('frontendConfiguration').get('Shel.Neos.CommandBar:CommandBar'),\n    nodeTypesRegistry: globalRegistry.get('@neos-project/neos-ui-contentrepository'),\n    editPreviewModes: globalRegistry.get('frontendConfiguration').get('editPreviewModes'),\n    plugins: globalRegistry.get('Shel.Neos.CommandBar').getChildrenAsObject('plugins'),\n}));\nexport default connect(() => ({}), {\n    toggleCommandBar: commandBarActions.toggleCommandBar,\n    addNode: actions.CR.Nodes.commenceCreation,\n    setEditPreviewMode: actions.UI.EditPreviewMode.set,\n    publishAction: actions.CR.Workspaces.publish,\n    discardAction: actions.CR.Workspaces.commenceDiscard,\n    setActiveContentCanvasContextPath: actions.CR.Nodes.setDocumentNode,\n    setActiveContentCanvasSrc: actions.UI.ContentCanvas.setSrc,\n})(connect(mapStateToProps, mapDispatchToProps)(mapGlobalRegistryToProps(CommandBarUiPlugin)));\n"],"sourceRoot":""}